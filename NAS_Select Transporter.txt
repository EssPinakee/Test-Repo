Admin

--2023-05-17 09:48:47
SELECT [TransportEmailDefinitions].IDTransportEmailDefinition AS [ID]
	,[TransportEmailDefinitions].TransportEmailDefinitionAccessRight AS [AccessRight]
	,[TransportEmailDefinitions].TransportEmailDefinitionActionIsRarelyUsed AS [ActionIsRarelyUsed]
	,[TransportEmailDefinitions].TransportEmailDefinitionActionType AS [ActionType]
	,[TransportEmailDefinitions].TransportEmailDefinitionAddDateTime AS [AddDateTime]
	,[TransportEmailDefinitions].TransportEmailDefinitionAddUserCode AS [AddUserCode]
	,[TransportEmailDefinitions].TransportEmailDefinitionAllActionName AS [AllActionName]
	,[TransportEmailDefinitions].TransportEmailDefinitionAllActionTooltip AS [AllActionTooltip]
	,[TransportEmailDefinitions].TransportEmailDefinitionAllConfirmationMessage AS [AllConfirmationMessage]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachAllRelatedFiles AS [AttachAllRelatedFiles]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachmentPreviewButtonName AS [AttachmentPreviewButtonName]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachmentPreviewButtonNameAdditional AS [AttachmentPreviewButtonNameAdditional]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachmentReportCode AS [AttachmentReportCode]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachmentReportCodeAdditional AS [AttachmentReportCodeAdditional]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachmentReportFileName AS [AttachmentReportFileName]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachmentReportFileNameAdditional AS [AttachmentReportFileNameAdditional]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachmentReportOutputType AS [AttachmentReportOutputType]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachmentReportOutputTypeAdditional AS [AttachmentReportOutputTypeAdditional]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachmentReportTag AS [AttachmentReportTag]
	,[TransportEmailDefinitions].TransportEmailDefinitionAttachmentReportTagAdditional AS [AttachmentReportTagAdditional]
	,[TransportEmailDefinitions].TransportEmailDefinitionBlindCarbonCopyEmail AS [BlindCarbonCopyEmail]
	,[TransportEmailDefinitions].TransportEmailDefinitionBlindCarbonCopyName AS [BlindCarbonCopyName]
	,[TransportEmailDefinitions].TransportEmailDefinitionBlindCarbonCopyToOwner AS [BlindCarbonCopyToOwner]
	,[TransportEmailDefinitions].TransportEmailDefinitionBody AS [Body]
	,[TransportEmailDefinitions].TransportEmailDefinitionBodyIsHTML AS [BodyIsHTML]
	,[TransportEmailDefinitions].TransportEmailDefinitionCarbonCopyEmail AS [CarbonCopyEmail]
	,[TransportEmailDefinitions].TransportEmailDefinitionCarbonCopyName AS [CarbonCopyName]
	,[TransportEmailDefinitions].TransportEmailDefinitionConsolidated AS [Consolidated]
	,[TransportEmailDefinitions].TransportEmailDefinitionCountryCode AS [CountryCode]
	,[TransportEmailDefinitions].TransportEmailDefinitionCriteriaStorageString AS [CriteriaStorageString]
	,[TransportEmailDefinitions].TransportEmailDefinitionDoneDateTimeField AS [DoneDateTimeField]
	,[TransportEmailDefinitions].TransportEmailDefinitionDoneYesNoField AS [DoneYesNoField]
	,[TransportEmailDefinitions].TransportEmailDefinitionDontSendForStatusChange AS [DontSendForStatusChange]
	,[TransportEmailDefinitions].TransportEmailDefinitionEditDateTime AS [EditDateTime]
	,[TransportEmailDefinitions].TransportEmailDefinitionEditUserCode AS [EditUserCode]
	,[TransportEmailDefinitions].TransportEmailDefinitionFormActionName AS [FormActionName]
	,[TransportEmailDefinitions].TransportEmailDefinitionFormActionTooltip AS [FormActionTooltip]
	,[TransportEmailDefinitions].TransportEmailDefinitionFormConfirmationMessage AS [FormConfirmationMessage]
	,[TransportEmailDefinitions].TransportEmailDefinitionLastRunDateTime AS [LastRunDateTime]
	,[TransportEmailDefinitions].TransportEmailDefinitionListingActionName AS [ListingActionName]
	,[TransportEmailDefinitions].TransportEmailDefinitionListingActionTooltip AS [ListingActionTooltip]
	,[TransportEmailDefinitions].TransportEmailDefinitionListingConfirmationMessage AS [ListingConfirmationMessage]
	,[TransportEmailDefinitions].TransportEmailDefinitionModule AS [Module]
	,[TransportEmailDefinitions].TransportEmailDefinitionName AS [Name]
	,[TransportEmailDefinitions].TransportEmailDefinitionOrderSendActionName AS [OrderSendActionName]
	,[TransportEmailDefinitions].TransportEmailDefinitionPriority AS [Priority]
	,[TransportEmailDefinitions].TransportEmailDefinitionReceiptSendActionName AS [ReceiptSendActionName]
	,[TransportEmailDefinitions].TransportEmailDefinitionRecipientEmail AS [RecipientEmail]
	,[TransportEmailDefinitions].TransportEmailDefinitionRecipientName AS [RecipientName]
	,[TransportEmailDefinitions].TransportEmailDefinitionSenderEmail AS [SenderEmail]
	,[TransportEmailDefinitions].TransportEmailDefinitionSenderName AS [SenderName]
	,[TransportEmailDefinitions].TransportEmailDefinitionSendTime AS [SendTime]
	,[TransportEmailDefinitions].TransportEmailDefinitionSubject AS [Subject]
	,[TransportEmailDefinitions].TransportEmailDefinitionTableID AS [TableID]
	,[TransportEmailDefinitions].TransportFileTypeID AS [TransportFileTypeID]
	,[TransportEmailDefinitions].TransportStatusIDAfterMailSend AS [TransportStatusIDAfterMailSend]
	,[TransportEmailDefinitions].TransportEmailDefinitionUseSubContextFilter AS [UseSubContextFilter]
	,[TransportEmailDefinitions].TransportEmailDefinitionWorkGroups AS [WorkGroups]
FROM TransportEmailDefinitions WITH (NOLOCK)
INNER JOIN (
	SELECT [TransportEmailDefinitions].IDTransportEmailDefinition AS [ID]
	FROM TransportEmailDefinitions WITH (NOLOCK)
	LEFT JOIN SubContextEmailDefinitions [TransportEmailDefinitions_SubContextEmailDefinitions] WITH (NOLOCK) ON TransportEmailDefinitions.IDTransportEmailDefinition = TransportEmailDefinitions_SubContextEmailDefinitions.EmailDefinitionID
	WHERE (
			[TransportEmailDefinitions].TransportEmailDefinitionListingActionName IS NOT NULL
			OR [TransportEmailDefinitions].TransportEmailDefinitionAllActionName IS NOT NULL
			)
		AND [TransportEmailDefinitions].TransportEmailDefinitionModule = N'Transports'
		AND (
			[TransportEmailDefinitions].TransportEmailDefinitionUseSubContextFilter = 0
			OR (
				[TransportEmailDefinitions_SubContextEmailDefinitions].SubContextCode IN (
					N'CN_CYI_OUT'
					,N'CN_ESQUEL'
					,N'CN_HASBRO'
					,N'CN_HKPACIFILO'
					,N'CN_HKUCPINTER'
					,N'CN_HKUNITEDCH'
					,N'CN_HP'
					,N'CN_HPOCP'
					,N'CN_JAKKSHK'
					,N'CN_JXDHK_OUT'
					,N'CN_LIFENGSH'
					,N'CN_LIFUNGHK'
					,N'CN_MACYS'
					,N'CN_MAXEDA'
					,N'CN_MGA'
					,N'CN_MITZI'
					,N'CN_PACNET'
					,N'CN_PLAYMATES'
					,N'CN_PRSAIR'
					,N'CN_PRSCL'
					,N'CN_PRSHAS'
					,N'CN_PRSMACY'
					,N'CN_PRSOCE'
					,N'CN_PRSPREMP'
					,N'CN_PRSSEARS'
					,N'CN_PRSVAS2'
					,N'CN_PRSVAS4'
					,N'CN_PRSWWW'
					,N'CN_PRSZTE'
					,N'CN_SCMPRS'
					,N'CN_SEARS'
					,N'CN_TARGETUS'
					,N'CN_WALMARTUS'
					,N'CN_WWW'
					,N'CN_XXXXXXXXXX'
					)
				OR [TransportEmailDefinitions_SubContextEmailDefinitions].SubContextCode IS NULL
				)
			)
	GROUP BY [TransportEmailDefinitions].IDTransportEmailDefinition
	) [Select_TransportEmailDefinitions] ON [TransportEmailDefinitions].IDTransportEmailDefinition = Select_TransportEmailDefinitions.ID

--Duration: 66ms
--2023-05-17 09:48:47
SELECT TOP 21 Transports.SubContextCode AS [Client]
	,Transports.TransportNumber AS [TO#]
	,Transports_TransportStatus.TransportStatusDisplayName AS [Status]
	,Transports.TransportCarrierID AS [Transporter code]
	,Transports.TransportThresholdType AS [Modality type]
	,Transports_FirstStop.TransportStopDeliveryDateTime AS [Transportation dt/tm]
	,Transports.IDTransport AS [ID]
	,Transports.TransportStatusID AS [Status ID]
	,Transports_TransportStatus.TransportStatusWarningLevel AS [Warning level]
	,Transports.TransportType AS [TO Haulage type]
	,Transports_FirstStop.TransportStopDeliveryAddress4 AS [First pick up Name - 2nd language]
	,Transports_FirstStop.TransportStopDeliveryReference2 AS [First pick up Address - 2nd language]
	,Transports_LastStop.TransportStopDeliveryRegionCode AS [Delivery Chargable location code]
	,Transports_LastStop.TransportStopDeliveryCompanyID AS [Delivery ID]
	,Transports_LastStop.TransportStopDeliveryAddress4 AS [Delivery Name - 2nd language]
	,Transports_LastStop.TransportStopDeliveryReference2 AS [Delivery Address - 2nd language]
	,CAST(Transports.TransportInternalNotes AS NVARCHAR(max)) AS [TO remark]
	,Transports.TransportPickUpCountry AS [Customs Clearance Mode]
	,Transports.TransportUserDefinedDateTime05 AS [SI Cut off dt/tm (Carrier)]
	,(
		SELECT MIN(TransportDetailRegionCode)
		FROM TransportDetails TD WITH (NOLOCK)
		INNER JOIN TransportStops [TS] WITH (NOLOCK) ON IDTransportStop = TD.TransportStopID
		WHERE TransportID = Transports.IDTransport
			AND TS.TransportStopNumber = 1
			AND TS.TransportStopType = 'Pick-up'
		) AS [SO#_1]
	,Transports.TransportCarrierName AS [Transporter name]
	,Transports.TransportTruckDriver AS [Driver name]
	,Transports.TransportTruckPhone AS [Mobile No]
	,Transports.TransportTruckLicensePlate AS [Licence tag]
	,Transports.TransportBasedOnOptimization AS [Any Stop Or Detail Cancelled]
	,Transports.TransportUserDefinedYesNo05 AS [TO Cancelled]
	,Transports_TOWithTotalAmount.CostAmount AS [Total Amount]
	,Transports.TransportExternalCompanySavedChargesDateTime AS [Charges saved dt/tm]
	,Transports.CurrencyCode AS [DG]
	,MAX(ISNULL(Transports.TransportFileUploadCount, 0)) AS [Transport Files Count]
	,Transports.TransportDirect AS [Domestic DO: Yes/No]
	,MAX(Transports_FirstStop_TransportDetails.CompanyIDSupplier) AS [Shipper Name]
	,Transports.CountryCode AS [Country code]
	,Transports.SubContextCode AS [Sub context code]
	,Transports.TransportSalesOrderNumber AS [FCR/HBL]
	,Transports.TransportChosenNonOptimalReasonCode AS [Container Tare Weight]
	,MAX(Transports_TransportStops_TransportDetails_Shipment.ShipmentConsigneeCity) AS [Bill Type]
	,MAX(Transports_TransportStops_TransportDetails_Shipment.ShipmentDelivery3CompanyID) AS [Shipper ID]
	,MAX(Transports_TransportStops_TransportDetails_Shipment.ShipmentConsigneeSCVCode) AS [CUS UID]
	,Transports_FirstStop.TransportStopDeliveryReference AS [First pick up State]
FROM Transports WITH (NOLOCK)
LEFT JOIN TransportStatuses [Transports_TransportStatus] WITH (NOLOCK) ON Transports.TransportStatusID = Transports_TransportStatus.IDTransportStatus
LEFT JOIN TransportStops [Transports_FirstStop] WITH (NOLOCK) ON Transports.TransportStopIDFirst = Transports_FirstStop.IDTransportStop
LEFT JOIN TransportStops [Transports_TransportStops] WITH (NOLOCK) ON Transports_TransportStops.TransportID = Transports.IDTransport
LEFT JOIN TransportDetails [Transports_TransportStops_TransportDetails] WITH (NOLOCK) ON Transports_TransportStops_TransportDetails.TransportStopID = Transports_TransportStops.IDTransportStop
LEFT JOIN TransportStops [Transports_LastStop] WITH (NOLOCK) ON Transports.TransportStopIDLast = Transports_LastStop.IDTransportStop
LEFT JOIN Companies [Transports_Company_3ACompanyIDCarrier] WITH (NOLOCK) ON Transports.TransportCarrierID = Transports_Company_3ACompanyIDCarrier.IDCompany
LEFT JOIN (
	SELECT BQ.TransportID AS TransportID
		,CAST(SUM(BC.BillingCostCostInvoiceCurrency) AS DECIMAL(18, 2)) AS CostAmount
	FROM Transports T WITH (NOLOCK)
	INNER JOIN BillingQuantities BQ WITH (NOLOCK) ON T.IDTransport = BQ.TransportID
	INNER JOIN BillingCosts BC WITH (NOLOCK) ON BQ.IDBillingQuantity = BC.BillingQuantityID
	GROUP BY BQ.TransportID
	) [Transports_TOWithTotalAmount] ON Transports.IDTransport = Transports_TOWithTotalAmount.TransportID
LEFT JOIN (
	SELECT BQ.TransportID AS TransportID
		,CAST(SUM(BC.BillingCostCostInvoiceCurrency) AS DECIMAL(18, 2)) AS CostAmount
	FROM Transports T WITH (NOLOCK)
	INNER JOIN BillingQuantities BQ WITH (NOLOCK) ON T.IDTransport = BQ.TransportID
	INNER JOIN BillingCosts BC WITH (NOLOCK) ON BQ.IDBillingQuantity = BC.BillingQuantityID
	LEFT JOIN CompanyRateCharges CR WITH (NOLOCK) ON CR.IDCompanyRateCharge = BQ.CompanyRateChargeID
	LEFT JOIN Charges C WITH (NOLOCK) ON CR.ChargeID = C.IDCharge
	WHERE C.ChargeName NOT LIKE '%Damco%'
	GROUP BY BQ.TransportID
	) [Transports_TruckerTotalChargeAmount] ON Transports.IDTransport = Transports_TruckerTotalChargeAmount.TransportID
LEFT JOIN TransportDetails [Transports_FirstStop_TransportDetails] WITH (NOLOCK) ON Transports_FirstStop_TransportDetails.TransportStopID = Transports_FirstStop.IDTransportStop
LEFT JOIN Shipments [Transports_TransportStops_TransportDetails_Shipment] WITH (NOLOCK) ON Transports_TransportStops_TransportDetails.ShipmentID = Transports_TransportStops_TransportDetails_Shipment.IDShipment
WHERE Transports.SubContextCode IN (
		N'CN_CYI_OUT'
		,N'CN_ESQUEL'
		,N'CN_HASBRO'
		,N'CN_HKPACIFILO'
		,N'CN_HKUCPINTER'
		,N'CN_HKUNITEDCH'
		,N'CN_HP'
		,N'CN_HPOCP'
		,N'CN_JAKKSHK'
		,N'CN_JXDHK_OUT'
		,N'CN_LIFENGSH'
		,N'CN_LIFUNGHK'
		,N'CN_MACYS'
		,N'CN_MAXEDA'
		,N'CN_MGA'
		,N'CN_MITZI'
		,N'CN_PACNET'
		,N'CN_PLAYMATES'
		,N'CN_PRSAIR'
		,N'CN_PRSCL'
		,N'CN_PRSHAS'
		,N'CN_PRSMACY'
		,N'CN_PRSOCE'
		,N'CN_PRSPREMP'
		,N'CN_PRSSEARS'
		,N'CN_PRSVAS2'
		,N'CN_PRSVAS4'
		,N'CN_PRSWWW'
		,N'CN_PRSZTE'
		,N'CN_SCMPRS'
		,N'CN_SEARS'
		,N'CN_TARGETUS'
		,N'CN_WALMARTUS'
		,N'CN_WWW'
		,N'CN_XXXXXXXXXX'
		)
	AND Transports.TransportStatusID IN (
		'9d636b3c-6ea4-470c-3e11-08d6246bf496'
		,'ecde70d4-5512-4783-83e1-08d0c3c20918'
		,'03ca7b3d-96d6-4be5-0158-08d0af4ff27a'
		,'6b13e018-14d8-42f2-b556-08d0c3c3c568'
		,'640e4aad-af0a-4f57-b585-08d0c3c2969d'
		,'6754e7a8-6deb-4658-0368-08d0c3c342a0'
		,'64830fe5-ef37-4c27-2734-08d0c3c4207f'
		,'4a3a64b7-60d4-438f-8895-08d0ca0b1817'
		,'444464b7-60d4-438f-8895-08d0ca0b1817'
		,'44447b3d-96d6-4be5-0158-08d0af4ff27a'
		,'23b98045-45d7-41af-8cc6-08d0b4cd259a'
		,'676aa683-7d19-414e-20ee-08d0d0fcb1cd'
		,'3ee9c4d7-bd44-4510-8557-63d37e7d6ffa'
		,'a14ffb0b-4c29-462a-efbf-08d0c3c1bb2e'
		,'9ec4eed2-0b98-427e-e04b-08d0c3c004d9'
		,'f399fd66-2408-4d15-ed5c-08d0c3c38a49'
		,'05530bf2-4c7b-49f8-0094-08d0c3c2cc05'
		,'fe01a795-038b-4017-1e16-08d0d0e5ef19'
		,'19495593-f1e8-4197-4a04-08d209076524'
		)
	AND Transports.DataEntryDefinitionID IN (
		'90b52adf-eb7b-4565-238f-08d0f61c8bae'
		,'757f6364-34ad-47f9-d597-08d0af500643'
		)
GROUP BY Transports.SubContextCode
	,Transports.TransportNumber
	,Transports_TransportStatus.TransportStatusDisplayName
	,Transports.TransportLastChequeNumber
	,Transports.TransportCarrierID
	,Transports.TransportThresholdType
	,Transports_FirstStop.TransportStopDeliveryDateTime
	,Transports.IDTransport
	,Transports.TransportStatusID
	,Transports_TransportStatus.TransportStatusWarningLevel
	,CAST(CASE 
			WHEN Transports_TransportStatus.TransportStatusWarningLevel IS NOT NULL
				AND TransportStatusWarningLevel >= 3
				THEN 1
			ELSE 0
			END AS BIT)
	,Transports.TransportType
	,Transports_FirstStop.TransportStopUserDefinedText02
	,Transports_FirstStop.TransportStopDeliveryCompanyID
	,Transports_FirstStop.TransportStopDeliveryCompanyName
	,Transports_FirstStop.TransportStopDeliveryAddress4
	,Transports_FirstStop.TransportStopDeliveryRegionCode
	,Transports_FirstStop.TransportStopDeliveryAddress1
	,Transports_FirstStop.TransportStopDeliveryReference2
	,Transports_FirstStop.TransportStopDeliveryZipCode
	,Transports_FirstStop.TransportStopDeliveryCity
	,Transports_LastStop.TransportStopDeliveryRegionCode
	,Transports_LastStop.TransportStopDeliveryCompanyID
	,Transports_LastStop.TransportStopDeliveryCompanyName
	,Transports_LastStop.TransportStopDeliveryAddress4
	,Transports_LastStop.TransportStopDeliveryReference2
	,CAST(Transports.TransportInternalNotes AS NVARCHAR(max))
	,Transports.TransportDock
	,Transports.TransportUserDefinedText08
	,Transports.TransportPickUpCountry
	,Transports_FirstStop.TransportStopDeliveryState
	,Transports.TransportUserDefinedDateTime05
	,Transports.TransportUserDefinedDateTime07
	,Transports.TransportUserDefinedDateTime04
	,Transports.TransportEstimatedDateTimeOfDeparture
	,Transports.TransportUserDefinedText14
	,Transports.TransportContainerNumber
	,Transports.TransportSeal1
	,Transports.TransportUserDefinedText15
	,Transports.TransportUserDefinedText06
	,Transports.TransportVesselCode
	,Transports.TransportVoyageCode
	,Transports.TransportEstimatedDateTimeOfArrival
	,Transports.TransportCarrierName
	,Transports.TransportTruckDriver
	,Transports.TransportTruckPhone
	,Transports.TransportTruckLicensePlate
	,Transports.TransportTruck2LicensePlate
	,Transports.TransportUserDefinedText01
	,CAST(Transports.TransportChosenNonOptimalReason AS NVARCHAR(max))
	,Transports.TransportUserDefinedText02
	,Transports.TransportRoute
	,Transports.TransportAddDateTime
	,Transports.TransportEditDateTime
	,Transports.TransportAddUserCode
	,Transports.TransportEditUserCode
	,Transports.TransportUserDefinedText09
	,Transports.TransportUserDefinedText10
	,Transports.TransportContact
	,Transports.TransportUserDefinedYesNo04
	,Transports.TransportOptimizationPlanName
	,Transports.TransportOptimizationPlanRunID
	,Transports.TransportUserDefinedText03
	,Transports.TransportContactPhone
	,CAST(Transports.TransportContactEmail AS NVARCHAR) + ISNULL(cast(' ; ' + CAST(Transports.TransportVesselName AS NVARCHAR) AS NVARCHAR), '')
	,Transports.TransportBasedOnOptimization
	,Transports.TransportUserDefinedYesNo05
	,CAST(Transports.TransportUserDefinedLongText03 AS NVARCHAR(max))
	,Transports_TOWithTotalAmount.CostAmount
	,Transports.TransportUserDefinedYesNo03
	,Transports.TransportExternalCompanySavedChargesDateTime
	,Transports_FirstStop.TransportStopDeliveryAddress3
	,Transports.CurrencyCode
	,CAST(Transports.TransportNotes AS NVARCHAR(max))
	,Transports.TransportDirect
	,Transports.CountryCode
	,Transports.SubContextCode
	,Transports.TransportSalesOrderNumber
	,Transports.TransportChosenNonOptimalReasonCode
	,Transports_FirstStop.TransportStopDeliveryReference
ORDER BY Transports.TransportEditDateTime DESC

--WCSPRHR1340
--Duration: 13323ms
--2023-05-17 09:48:33
SELECT DISTINCT ListTable.IDCompany AS [ValueField]
	,ListTable.CompanyName AS [DisplayField]
FROM Companies [ListTable] WITH (NOLOCK)

--Duration: 57ms
--2023-05-17 09:48:33
SELECT DISTINCT ListTable.TransportOptimizationPlanName AS [ValueField]
FROM TransportOptimizationPlans [ListTable] WITH (NOLOCK)

--Duration: 10ms
--2023-05-17 09:48:33
SELECT DISTINCT ListTable.InterfaceItemString01 AS [ValueField]
FROM InterfaceItems [ListTable] WITH (NOLOCK)
WHERE (InterfaceTableDefinitionCode = 'KpiReason')

--Duration: 55ms
--2023-05-17 09:48:33
SELECT DISTINCT ListTable.TransportType AS [ValueField]
	,ListTable.TransportType AS [DisplayField]
FROM (
	SELECT 'FCL' AS TransportType
	
	UNION ALL
	
	SELECT 'FCL-Milkrun'
	
	UNION ALL
	
	SELECT 'CY-Topoff'
	
	UNION ALL
	
	SELECT 'LCL'
	
	UNION ALL
	
	SELECT 'LCL-Milkrun'
	) [ListTable]

--Duration: 1ms
--2023-05-17 09:48:33
SELECT DISTINCT ListTable.IDTransportStatus AS [ValueField]
	,ListTable.TransportStatusName AS [DisplayField]
FROM TransportStatuses [ListTable] WITH (NOLOCK)

--Duration: 1ms
--2023-05-17 09:48:33
SELECT DISTINCT ListTable.TransportStatusDisplayName AS [ValueField]
	,ListTable.TransportStatusDisplayName AS [DisplayField]
FROM TransportStatuses [ListTable] WITH (NOLOCK)
WHERE ListTable.TransportStatusDisplayName IN (
		N'Sent to transporter'
		,N'Transporter accepted'
		,N'Planned'
		,N'Costs accepted'
		,N'Transporter rejected'
		,N'Check costs'
		,N'Finished'
		,N'Complete TO info'
		,N'Complete TO info'
		,N'Planned'
		,N'Cancelled'
		,N'Recalled from transporter'
		,N'Check costs'
		,N'Sent to transporter'
		,N'Select transporter'
		,N'Costs rejected'
		,N'Details confirmed'
		,N'Transporter accepted'
		,N'Transporter accepted'
		)

--Duration: 4ms
--2023-05-17 09:48:33
INSERT INTO TransportLogs (
	[IDTransportLog]
	,[TransportLogDateTime]
	,[TransportLogEmailID]
	,[TransportLogEvent]
	,[TransportLogInfo]
	,[TransportLogTechnicalInfo]
	,[TransportDetailID]
	,[TransportDocumentID]
	,[TransportEmailDefinitionID]
	,[TransportID]
	,[TransportLevelFileID]
	,[TransportStatusID]
	,[TransportStopID]
	,[TransportLogUserLogin]
	)
SELECT '854281a4-81fd-4dfc-0a85-08db56bbe0f6'
	,'20230517 09:48:33.615'
	,NULL
	,N'Transport changed'
	,N'

Changes
Transporter code: CN_GAT
Transporter name: SHENZHEN GUOAN FREIGHT CO., LTD.
Transporter contact: 曾丽云/王先生/黄先生
Telephone No.: 25260990/25260885/ 15986682809
Transporter Mail: yzengguoan@163.com;business@dongyajoint.com
Default Customs Broker Code: CN_GAT
Customs Broker Code: CN_GAT
Customs Broker Name: SHENZHEN GUOAN FREIGHT CO., LTD.
Contact: 曾丽云/王先生/黄先生
Telephone No.: 25260990/25260885/ 15986682809
Customs Broker Mail: yzengguoan@163.com;business@dongyajoint.com'
	,N'Key: 0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,NULL
	,NULL
	,NULL
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,NULL
	,'9ec4eed2-0b98-427e-e04b-08d0c3c004d9'
	,NULL
	,N'NXY001'

--Duration: 76ms
--2023-05-17 09:48:33
UPDATE Transports
SET [TransportCarrierEmail] = N'yzengguoan@163.com;business@dongyajoint.com'
	,[TransportCarrierID] = N'CN_GAT'
	,[TransportCarrierName] = N'SHENZHEN GUOAN FREIGHT CO., LTD.'
	,[TransportDepartment] = N'曾丽云/王先生/黄先生'
	,[TransportEditDateTime] = '20230517 09:48:33.286'
	,[TransportEditUserCode] = N'NXY001'
	,[TransportPickUpCompanyID] = N'CN_GAT'
	,[TransportPickupCompanyName] = N'SHENZHEN GUOAN FREIGHT CO., LTD.'
	,[TransportPickUpReference] = N'曾丽云/王先生/黄先生'
	,[TransportPickUpState] = N'25260990/25260885/ 15986682809'
	,[TransportPickUpZipCode] = N'yzengguoan@163.com;business@dongyajoint.com'
	,[TransportTruck2LicensePlate] = N'25260990/25260885/ 15986682809'
	,[TransportUserDefinedText05] = N'CN_GAT'
FROM Transports [Transport] WITH (NOLOCK)
WHERE IDTransport = '0273339f-86ad-43ae-37d7-08dae6f3be3f'

--Duration: 273ms
--2023-05-17 09:48:33
SELECT TOP 1 [Companies].IDCompany AS [ID]
	,[Companies].CompanyName AS [Name]
	,[Companies].CompanyContact2 AS [Contact2]
	,[Companies].CompanyPhoneNumber2 AS [PhoneNumber2]
	,[Companies].CompanyEmail2 AS [Email2]
FROM Companies WITH (NOLOCK)
WHERE [Companies].IDCompany = N'CN_GAT'

--Duration: 3ms
--2023-05-17 09:48:33
SELECT TOP 1 [Companies].IDCompany AS [ID]
	,[Companies].CompanyName AS [Name]
	,[Companies].CompanyContact1 AS [Contact1]
	,[Companies].CompanyPhoneNumber1 AS [PhoneNumber1]
	,[Companies].CompanyEmail1 AS [Email1]
	,[Companies].CompanyBillToZipCode AS [BillToZipCode]
FROM Companies WITH (NOLOCK)
WHERE [Companies].IDCompany = N'CN_GAT'

--Duration: 14ms
--2023-05-17 09:48:33
SELECT [Transports].IDTransport AS [ID]
	,[Transports].TransportActualArrivalDateTime AS [ActualArrivalDateTime]
	,[Transports].TransportActualCarrierID AS [ActualCarrierID]
	,[Transports].TransportAddDateTime AS [AddDateTime]
	,[Transports].TransportAddUserCode AS [AddUserCode]
	,[Transports].TransportBasedOnOptimization AS [BasedOnOptimization]
	,[Transports].TransportCarrierEmail AS [CarrierEmail]
	,[Transports].TransportCarrierID AS [CarrierID]
	,[Transports].TransportCarrierName AS [CarrierName]
	,[Transports].TransportCarrierRemarks AS [CarrierRemarks]
	,[Transports].TransportChangedDataStorageString AS [ChangedDataStorageString]
	,[Transports].TransportChangesAcceptedDateTime AS [ChangesAcceptedDateTime]
	,[Transports].TransportCharges AS [Charges]
	,[Transports].TransportCheapestSolutionCost AS [CheapestSolutionCost]
	,[Transports].TransportCheapestSolutionRevenue AS [CheapestSolutionRevenue]
	,[Transports].TransportChosenNonOptimalReason AS [ChosenNonOptimalReason]
	,[Transports].TransportChosenNonOptimalReasonCode AS [ChosenNonOptimalReasonCode]
	,[Transports].TransportChosenSolutionCost AS [ChosenSolutionCost]
	,[Transports].TransportChosenSolutionRevenue AS [ChosenSolutionRevenue]
	,[Transports].TransportCompanyID AS [CompanyID]
	,[Transports].TransportContact AS [Contact]
	,[Transports].TransportContactEmail AS [ContactEmail]
	,[Transports].TransportContactPhone AS [ContactPhone]
	,[Transports].TransportContainerNumber AS [ContainerNumber]
	,[Transports].TransportContainerType AS [ContainerType]
	,[Transports].TransportCostsEstimated AS [CostsEstimated]
	,[Transports].TransportCostsParkingFee AS [CostsParkingFee]
	,[Transports].TransportCostsRoadTolls AS [CostsRoadTolls]
	,[Transports].TransportCostsWaitingFee AS [CostsWaitingFee]
	,[Transports].CountryCode AS [CountryCode]
	,[Transports].TransportCreationDataSource AS [CreationDataSource]
	,[Transports].TransportCreationRunDateTime AS [CreationRunDateTime]
	,[Transports].CurrencyCode AS [CurrencyCode]
	,[Transports].TransportCustomsConfirmed AS [CustomsConfirmed]
	,[Transports].DataEntryDefinitionID AS [DataEntryDefinitionID]
	,[Transports].TransportDeliveryDateTime AS [DeliveryDateTime]
	,[Transports].TransportDepartment AS [Department]
	,[Transports].TransportDirect AS [Direct]
	,[Transports].TransportDiscrepancey AS [Discrepancey]
	,[Transports].TransportDock AS [Dock]
	,[Transports].TransportDockDateTime AS [DockDateTime]
	,[Transports].TransportDockIsCleared AS [DockIsCleared]
	,[Transports].TransportEditDateTime AS [EditDateTime]
	,[Transports].TransportEditUserCode AS [EditUserCode]
	,[Transports].TransportEndLoadingDateTime AS [EndLoadingDateTime]
	,[Transports].TransportEndUnloadingDateTime AS [EndUnloadingDateTime]
	,[Transports].TransportEstimatedDateTimeOfArrival AS [EstimatedDateTimeOfArrival]
	,[Transports].TransportEstimatedDateTimeOfDeparture AS [EstimatedDateTimeOfDeparture]
	,[Transports].TransportExternalCompanySavedChargesDateTime AS [ExternalCompanySavedChargesDateTime]
	,[Transports].TransportExtraStopCosts AS [ExtraStopCosts]
	,[Transports].TransportFileUploadCount AS [FileUploadCount]
	,[Transports].TransportFreightWeight AS [FreightWeight]
	,[Transports].TransportFuelSurcharge AS [FuelSurcharge]
	,[Transports].TransportFuelSurchargePercentage AS [FuelSurchargePercentage]
	,[Transports].TransportHaulageType AS [HaulageType]
	,[Transports].TransportImportBatch AS [ImportBatch]
	,[Transports].TransportInternalNotes AS [InternalNotes]
	,[Transports].TransportLastChequeNumber AS [LastChequeNumber]
	,[Transports].TransportLastComment AS [LastComment]
	,[Transports].TransportLastExternalChangeDateTime AS [LastExternalChangeDateTime]
	,[Transports].TransportLastFlagExternalChangeHandledDateTime AS [LastFlagExternalChangeHandledDateTime]
	,[Transports].TransportLastStopMoveDateTime AS [LastStopMoveDateTime]
	,[Transports].TransportLoadMetres AS [LoadMetres]
	,[Transports].TransportNewEDIPending AS [NewEDIPending]
	,[Transports].TransportNotes AS [Notes]
	,[Transports].TransportNumber AS [Number]
	,[Transports].TransportOptimizationPlanName AS [OptimizationPlanName]
	,[Transports].TransportOptimizationPlanRunID AS [OptimizationPlanRunID]
	,[Transports].PalletTypeCode AS [PalletTypeCode]
	,[Transports].TransportPickUpAddress1 AS [PickUpAddress1]
	,[Transports].TransportPickUpAddress2 AS [PickUpAddress2]
	,[Transports].TransportPickUpAddress3 AS [PickUpAddress3]
	,[Transports].TransportPickUpAddress4 AS [PickUpAddress4]
	,[Transports].TransportPickUpCity AS [PickUpCity]
	,[Transports].TransportPickUpCompanyID AS [PickUpCompanyID]
	,[Transports].TransportPickupCompanyName AS [PickupCompanyName]
	,[Transports].TransportPickUpCountry AS [PickUpCountry]
	,[Transports].TransportPickupDateTime AS [PickupDateTime]
	,[Transports].TransportPickupMoment AS [PickupMoment]
	,[Transports].TransportPickUpReference AS [PickUpReference]
	,[Transports].TransportPickUpState AS [PickUpState]
	,[Transports].TransportPickUpZipCode AS [PickUpZipCode]
	,[Transports].TransportPurchaseOrderNumber AS [PurchaseOrderNumber]
	,[Transports].TransportReadyForBillingDateTime AS [ReadyForBillingDateTime]
	,[Transports].TransportReadyForMatrixBillingDateTime AS [ReadyForMatrixBillingDateTime]
	,[Transports].TransportReadyForWaitingTimeBillingDateTime AS [ReadyForWaitingTimeBillingDateTime]
	,[Transports].TransportRoute AS [Route]
	,[Transports].TransportRuleType AS [RuleType]
	,[Transports].TransportSalesOrderNumber AS [SalesOrderNumber]
	,[Transports].TransportSeal1 AS [Seal1]
	,[Transports].TransportSeal2 AS [Seal2]
	,[Transports].TransportStartLoadingDateTime AS [StartLoadingDateTime]
	,[Transports].TransportStartUnloadingDateTime AS [StartUnloadingDateTime]
	,[Transports].TransportStatusChangeDateTime AS [StatusChangeDateTime]
	,[Transports].TransportStatusID AS [StatusID]
	,[Transports].TransportStatusIDPrevious AS [StatusIDPrevious]
	,[Transports].TransportStopIDFirst AS [StopIDFirst]
	,[Transports].TransportStopIDLast AS [StopIDLast]
	,[Transports].SubContextCode AS [SubContextCode]
	,[Transports].TransportThresholdType AS [ThresholdType]
	,[Transports].TransportTrailer2LicensePlate AS [Trailer2LicensePlate]
	,[Transports].TransportTrailerLicensePlate AS [TrailerLicensePlate]
	,[Transports].TransportTransportCosts AS [TransportCosts]
	,[Transports].TransportTruck2LicensePlate AS [Truck2LicensePlate]
	,[Transports].TransportTruckDriver AS [TruckDriver]
	,[Transports].TransportTruckLicensePlate AS [TruckLicensePlate]
	,[Transports].TransportTruckPhone AS [TruckPhone]
	,[Transports].TransportTruckType AS [TruckType]
	,[Transports].TransportType AS [Type]
	,[Transports].TransportUserDefinedDate01 AS [UserDefinedDate01]
	,[Transports].TransportUserDefinedDate02 AS [UserDefinedDate02]
	,[Transports].TransportUserDefinedDateTime01 AS [UserDefinedDateTime01]
	,[Transports].TransportUserDefinedDateTime02 AS [UserDefinedDateTime02]
	,[Transports].TransportUserDefinedDateTime03 AS [UserDefinedDateTime03]
	,[Transports].TransportUserDefinedDateTime04 AS [UserDefinedDateTime04]
	,[Transports].TransportUserDefinedDateTime05 AS [UserDefinedDateTime05]
	,[Transports].TransportUserDefinedDateTime06 AS [UserDefinedDateTime06]
	,[Transports].TransportUserDefinedDateTime07 AS [UserDefinedDateTime07]
	,[Transports].TransportUserDefinedDateTime08 AS [UserDefinedDateTime08]
	,[Transports].TransportUserDefinedDateTime09 AS [UserDefinedDateTime09]
	,[Transports].TransportUserDefinedDateTime10 AS [UserDefinedDateTime10]
	,[Transports].TransportUserDefinedDateTime11 AS [UserDefinedDateTime11]
	,[Transports].TransportUserDefinedDateTime12 AS [UserDefinedDateTime12]
	,[Transports].TransportUserDefinedDateTime13 AS [UserDefinedDateTime13]
	,[Transports].TransportUserDefinedDateTime14 AS [UserDefinedDateTime14]
	,[Transports].TransportUserDefinedDateTime15 AS [UserDefinedDateTime15]
	,[Transports].TransportUserDefinedLongText01 AS [UserDefinedLongText01]
	,[Transports].TransportUserDefinedLongText02 AS [UserDefinedLongText02]
	,[Transports].TransportUserDefinedLongText03 AS [UserDefinedLongText03]
	,[Transports].TransportUserDefinedLongText04 AS [UserDefinedLongText04]
	,[Transports].TransportUserDefinedLongText05 AS [UserDefinedLongText05]
	,[Transports].TransportUserDefinedNumber01 AS [UserDefinedNumber01]
	,[Transports].TransportUserDefinedNumber02 AS [UserDefinedNumber02]
	,[Transports].TransportUserDefinedNumber03 AS [UserDefinedNumber03]
	,[Transports].TransportUserDefinedNumber04 AS [UserDefinedNumber04]
	,[Transports].TransportUserDefinedNumber05 AS [UserDefinedNumber05]
	,[Transports].TransportUserDefinedNumber06 AS [UserDefinedNumber06]
	,[Transports].TransportUserDefinedNumber07 AS [UserDefinedNumber07]
	,[Transports].TransportUserDefinedNumber08 AS [UserDefinedNumber08]
	,[Transports].TransportUserDefinedNumber09 AS [UserDefinedNumber09]
	,[Transports].TransportUserDefinedNumber10 AS [UserDefinedNumber10]
	,[Transports].TransportUserDefinedNumber11 AS [UserDefinedNumber11]
	,[Transports].TransportUserDefinedNumber12 AS [UserDefinedNumber12]
	,[Transports].TransportUserDefinedNumber13 AS [UserDefinedNumber13]
	,[Transports].TransportUserDefinedNumber14 AS [UserDefinedNumber14]
	,[Transports].TransportUserDefinedNumber15 AS [UserDefinedNumber15]
	,[Transports].TransportUserDefinedNumber16 AS [UserDefinedNumber16]
	,[Transports].TransportUserDefinedNumber17 AS [UserDefinedNumber17]
	,[Transports].TransportUserDefinedNumber18 AS [UserDefinedNumber18]
	,[Transports].TransportUserDefinedNumber19 AS [UserDefinedNumber19]
	,[Transports].TransportUserDefinedNumber20 AS [UserDefinedNumber20]
	,[Transports].TransportUserDefinedText01 AS [UserDefinedText01]
	,[Transports].TransportUserDefinedText02 AS [UserDefinedText02]
	,[Transports].TransportUserDefinedText03 AS [UserDefinedText03]
	,[Transports].TransportUserDefinedText04 AS [UserDefinedText04]
	,[Transports].TransportUserDefinedText05 AS [UserDefinedText05]
	,[Transports].TransportUserDefinedText06 AS [UserDefinedText06]
	,[Transports].TransportUserDefinedText07 AS [UserDefinedText07]
	,[Transports].TransportUserDefinedText08 AS [UserDefinedText08]
	,[Transports].TransportUserDefinedText09 AS [UserDefinedText09]
	,[Transports].TransportUserDefinedText10 AS [UserDefinedText10]
	,[Transports].TransportUserDefinedText11 AS [UserDefinedText11]
	,[Transports].TransportUserDefinedText12 AS [UserDefinedText12]
	,[Transports].TransportUserDefinedText13 AS [UserDefinedText13]
	,[Transports].TransportUserDefinedText14 AS [UserDefinedText14]
	,[Transports].TransportUserDefinedText15 AS [UserDefinedText15]
	,[Transports].TransportUserDefinedYesNo01 AS [UserDefinedYesNo01]
	,[Transports].TransportUserDefinedYesNo02 AS [UserDefinedYesNo02]
	,[Transports].TransportUserDefinedYesNo03 AS [UserDefinedYesNo03]
	,[Transports].TransportUserDefinedYesNo04 AS [UserDefinedYesNo04]
	,[Transports].TransportUserDefinedYesNo05 AS [UserDefinedYesNo05]
	,[Transports].TransportValueAddedTax AS [ValueAddedTax]
	,[Transports].TransportVesselCode AS [VesselCode]
	,[Transports].TransportVesselName AS [VesselName]
	,[Transports].TransportVolume AS [Volume]
	,[Transports].TransportVoyageCode AS [VoyageCode]
	,[Transports].TransportWaitingFeeEstimated AS [WaitingFeeEstimated]
FROM Transports WITH (NOLOCK)
WHERE [Transports].IDTransport = '0273339f-86ad-43ae-37d7-08dae6f3be3f'

--Duration: 3ms
--2023-05-17 09:48:33
SELECT TOP 4000 Companies.IDCompany AS [ID]
	,Companies.CompanyName AS [Name]
	,CAST(MIN(CAST(CAST(CASE 
						WHEN Companies_BundlePossibilities.BundlePossibilityTotalCosts IS NULL
							THEN 1
						ELSE 0
						END AS BIT) AS INT)) AS BIT) AS [Total costs]
	,SUM(CASE 
			WHEN (Companies_BundlePossibilities.BundlePossibilityTotalCosts) = 0
				THEN NULL
			ELSE Companies_BundlePossibilities.BundlePossibilityTotalCosts
			END) AS [Total costs (USD)]
	,SUM(Companies_BundlePossibilities.BundlePossibilityTotalRevenue - Companies_BundlePossibilities.BundlePossibilityTotalCosts) AS [CM1 (USD)]
FROM Companies WITH (NOLOCK)
LEFT JOIN BundlePossibilities [Companies_BundlePossibilities] WITH (NOLOCK) ON (Companies_BundlePossibilities.CompanyIDCarrier = Companies.IDCompany)
	AND (Companies_BundlePossibilities.BundlePossibilitySessionID = '6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88')
WHERE Companies.CompanyType = N'6'
GROUP BY Companies.IDCompany
	,Companies.CompanyName
	,Companies.CountryCodeControl
ORDER BY [Total costs]
	,[Total costs (USD)]
	,[ID]

--WCSPRHR1443
--Duration: 12ms
--2023-05-17 09:48:33
SELECT DISTINCT ListTable.CountryCode AS [ValueField]
	,ListTable.CountryName AS [DisplayField]
FROM Countries [ListTable] WITH (NOLOCK)

--Duration: 3ms
--2023-05-17 09:48:33
SELECT DISTINCT ListTable.IDCompanyType AS [ValueField]
	,ListTable.CompanyTypeName AS [DisplayField]
FROM CompanyTypes [ListTable] WITH (NOLOCK)

--Duration: 2ms
--2023-05-17 09:48:32
SELECT DISTINCT ListTable.CompanyName AS [ValueField]
	,ListTable.CompanyName AS [DisplayField]
FROM Companies [ListTable] WITH (NOLOCK)

--Duration: 61ms
--2023-05-17 09:48:32
SELECT [TransportStatuses].IDTransportStatus AS [ID]
	,[TransportStatuses].TransportStatusActionIsRarelyUsed AS [ActionIsRarelyUsed]
	,[TransportStatuses].TransportStatusActionName AS [ActionName]
	,[TransportStatuses].TransportStatusActionTooltip AS [ActionTooltip]
	,[TransportStatuses].TransportStatusActionType AS [ActionType]
	,[TransportStatuses].TransportStatusAddDateTime AS [AddDateTime]
	,[TransportStatuses].TransportStatusAddRemarkAccessRight AS [AddRemarkAccessRight]
	,[TransportStatuses].TransportStatusAddUserCode AS [AddUserCode]
	,[TransportStatuses].TransportStatusAllowManualPriceCalculation AS [AllowManualPriceCalculation]
	,[TransportStatuses].TransportStatusAllowOrderSelection AS [AllowOrderSelection]
	,[TransportStatuses].TransportStatusAllowPriceCalculation AS [AllowPriceCalculation]
	,[TransportStatuses].TransportStatusAllowReceiptSelection AS [AllowReceiptSelection]
	,[TransportStatuses].TransportStatusCancelled AS [Cancelled]
	,[TransportStatuses].TransportStatusChangeAllActionName AS [ChangeAllActionName]
	,[TransportStatuses].TransportStatusChangeAllActionTooltip AS [ChangeAllActionTooltip]
	,[TransportStatuses].TransportStatusChangeAllConfirmationMessage AS [ChangeAllConfirmationMessage]
	,[TransportStatuses].TransportStatusConfirmationMessage AS [ConfirmationMessage]
	,[TransportStatuses].TransportStatusConfirmCustomsAccessRight AS [ConfirmCustomsAccessRight]
	,[TransportStatuses].TransportStatusDisplayName AS [DisplayName]
	,[TransportStatuses].TransportStatusDone AS [Done]
	,[TransportStatuses].TransportStatusEditAccessRight AS [EditAccessRight]
	,[TransportStatuses].TransportStatusEditDateTime AS [EditDateTime]
	,[TransportStatuses].TransportStatusEditUserCode AS [EditUserCode]
	,[TransportStatuses].TransportStatusGoBackToListingAfterChange AS [GoBackToListingAfterChange]
	,[TransportStatuses].TransportStatusListingActionName AS [ListingActionName]
	,[TransportStatuses].TransportStatusListingActionTooltip AS [ListingActionTooltip]
	,[TransportStatuses].TransportStatusListingConfirmationMessage AS [ListingConfirmationMessage]
	,[TransportStatuses].TransportStatusMaximumChangedItemsAtOnce AS [MaximumChangedItemsAtOnce]
	,[TransportStatuses].TransportStatusModule AS [Module]
	,[TransportStatuses].TransportStatusModuleUpdateType AS [ModuleUpdateType]
	,[TransportStatuses].TransportStatusName AS [Name]
	,[TransportStatuses].TransportStatusNotes AS [Notes]
	,[TransportStatuses].TransportStatusNumber AS [Number]
	,[TransportStatuses].TransportStatusOrderActionName AS [OrderActionName]
	,[TransportStatuses].TransportStatusOrderActionTooltip AS [OrderActionTooltip]
	,[TransportStatuses].TransportStatusReadyForBilling AS [ReadyForBilling]
	,[TransportStatuses].TransportStatusReadyForInvoicing AS [ReadyForInvoicing]
	,[TransportStatuses].TransportStatusReadyForMatrixBilling AS [ReadyForMatrixBilling]
	,[TransportStatuses].TransportStatusReadyForWaitingTimeBilling AS [ReadyForWaitingTimeBilling]
	,[TransportStatuses].TransportStatusRecalculateForOrderChange AS [RecalculateForOrderChange]
	,[TransportStatuses].TransportStatusRecalculateForReceiptChange AS [RecalculateForReceiptChange]
	,[TransportStatuses].TransportStatusReceiptActionName AS [ReceiptActionName]
	,[TransportStatuses].TransportStatusReceiptActionTooltip AS [ReceiptActionTooltip]
	,[TransportStatuses].TransportStatusRequiresValidation AS [RequiresValidation]
	,[TransportStatuses].TransportStatusSetMessage AS [SetMessage]
	,[TransportStatuses].TransportStatusShowPriceToCustomer AS [ShowPriceToCustomer]
	,[TransportStatuses].TransportStatusStatusChangeAccessRight AS [StatusChangeAccessRight]
	,[TransportStatuses].TransportStatusViewAccessRight AS [ViewAccessRight]
	,[TransportStatuses].TransportStatusWarningLevel AS [WarningLevel]
FROM TransportStatuses WITH (NOLOCK)
WHERE [TransportStatuses].TransportStatusModule = N'Transports'

--Duration: 1ms
--2023-05-17 09:48:32
SELECT [DataEntryDefinitionOptions].DataEntryDefinitionOptionCode AS [Code]
	,[DataEntryDefinitionOptions].DataEntryDefinitionID AS [DefinitionID]
	,[DataEntryDefinitionOptions].DataEntryDefinitionOptionAddDateTime AS [AddDateTime]
	,[DataEntryDefinitionOptions].DataEntryDefinitionOptionAddUserCode AS [AddUserCode]
	,[DataEntryDefinitionOptions].DataEntryDefinitionOptionEditDateTime AS [EditDateTime]
	,[DataEntryDefinitionOptions].DataEntryDefinitionOptionEditUserCode AS [EditUserCode]
	,[DataEntryDefinitionOptions].DataEntryDefinitionOptionValue AS [Value]
FROM DataEntryDefinitionOptions WITH (NOLOCK)
LEFT JOIN DataEntryDefinitions [DataEntryDefinitionOptions_Definition] WITH (NOLOCK) ON DataEntryDefinitionOptions.DataEntryDefinitionID = DataEntryDefinitionOptions_Definition.IDDataEntryDefinition
WHERE [DataEntryDefinitionOptions].DataEntryDefinitionOptionCode IN (
		N'AllowExcelImport'
		,N'AddButtonText'
		,N'StartStatus'
		)
	AND [DataEntryDefinitionOptions_Definition].DataEntryDefinitionDataEntryType = N'Transport'
ORDER BY CAST([DataEntryDefinitionOptions].DataEntryDefinitionOptionValue AS NVARCHAR(max)) DESC

--Duration: 2ms
--2023-05-17 09:47:33
SELECT TOP 4000 Companies.IDCompany AS [ID]
	,Companies.CompanyName AS [Name]
	,CAST(MIN(CAST(CAST(CASE 
						WHEN Companies_BundlePossibilities.BundlePossibilityTotalCosts IS NULL
							THEN 1
						ELSE 0
						END AS BIT) AS INT)) AS BIT) AS [Total costs]
	,SUM(CASE 
			WHEN (Companies_BundlePossibilities.BundlePossibilityTotalCosts) = 0
				THEN NULL
			ELSE Companies_BundlePossibilities.BundlePossibilityTotalCosts
			END) AS [Total costs (USD)]
	,SUM(Companies_BundlePossibilities.BundlePossibilityTotalRevenue - Companies_BundlePossibilities.BundlePossibilityTotalCosts) AS [CM1 (USD)]
FROM Companies WITH (NOLOCK)
LEFT JOIN BundlePossibilities [Companies_BundlePossibilities] WITH (NOLOCK) ON (Companies_BundlePossibilities.CompanyIDCarrier = Companies.IDCompany)
	AND (Companies_BundlePossibilities.BundlePossibilitySessionID = '6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88')
WHERE Companies.CompanyType = N'6'
GROUP BY Companies.IDCompany
	,Companies.CompanyName
	,Companies.CountryCodeControl
ORDER BY [Total costs]
	,[Total costs (USD)]
	,[ID]

--WCSPRHR1443
--Duration: 91ms
--2023-05-17 09:47:32
SELECT DISTINCT ListTable.CountryCode AS [ValueField]
	,ListTable.CountryName AS [DisplayField]
FROM Countries [ListTable] WITH (NOLOCK)

--Duration: 4ms
--2023-05-17 09:47:32
SELECT DISTINCT ListTable.IDCompanyType AS [ValueField]
	,ListTable.CompanyTypeName AS [DisplayField]
FROM CompanyTypes [ListTable] WITH (NOLOCK)

--Duration: 7ms
--2023-05-17 09:47:32
SELECT DISTINCT ListTable.CompanyName AS [ValueField]
	,ListTable.CompanyName AS [DisplayField]
FROM Companies [ListTable] WITH (NOLOCK)

--Duration: 135ms
--2023-05-17 09:47:32
SELECT [Report].ReportCode AS [Code]
	,[Report].ReportAddDateTime AS [AddDateTime]
	,[Report].ReportAddUserCode AS [AddUserCode]
	,[Report].ReportDescription AS [Description]
	,[Report].ReportDRLString AS [DRLString]
	,[Report].ReportEditDateTime AS [EditDateTime]
	,[Report].ReportEditUserCode AS [EditUserCode]
	,[Report].ReportName AS [Name]
	,[Report].ReportNotes AS [Notes]
	,[Report].ReportShowInMenu AS [ShowInMenu]
	,[Report].ReportSubMenu AS [SubMenu]
FROM Reports [Report] WITH (NOLOCK)
WHERE [Report].ReportCode = N'WCSPRHR1443'

--Duration: 21ms
--2023-05-17 09:47:32
DELETE BundlePossibilities
FROM BundlePossibilities WITH (NOLOCK)
WHERE [BundlePossibilities].BundlePossibilityAddDateTime < '20230516 09:47:32.253'

--Duration: 13ms
--2023-05-17 09:47:32
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT 'fc567999-66b8-4694-a3ef-08db56bbbc54'
	,'20230517 09:47:32.237'
	,N'NXY001'
	,N'983a83f8927e42eebe8adaa49d116550'
	,N'40HQ'
	,N'CN_YIHOHK'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 674.00000000000000000000
Wave using tariff: 674.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 674.00000000000000000000
Wave using tariff: 674.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 674.00; Costs: 674.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,15
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,674.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 5ms
--2023-05-17 09:47:32
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_YIHOHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 24ms
--2023-05-17 09:47:32
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_YIHOHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 51ms
--2023-05-17 09:47:32
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT '63881609-5c0b-4348-540b-08db56bbbc46'
	,'20230517 09:47:32.143'
	,N'NXY001'
	,N'7f7d9ecfce5f4d4a81ef5123f0a4758c'
	,N'40HQ'
	,N'CN_XHDHK'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 752.00000000000000000000
Wave using tariff: 752.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 752.00000000000000000000
Wave using tariff: 752.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 752.00; Costs: 752.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,14
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,752.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 6ms
--2023-05-17 09:47:32
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_XHDHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 27ms
--2023-05-17 09:47:32
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_XHDHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 36ms
--2023-05-17 09:47:32
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT '086db507-e3be-45e9-68d0-08db56bbbc3a'
	,'20230517 09:47:32.065'
	,N'NXY001'
	,N'c62b7e5a8e60430f83c2acb452fd9976'
	,N'40HQ'
	,N'CN_XDLHK'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 693.00000000000000000000
Wave using tariff: 693.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 693.00000000000000000000
Wave using tariff: 693.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 693.00; Costs: 693.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,13
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,693.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 4ms
--2023-05-17 09:47:32
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_XDLHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 22ms
--2023-05-17 09:47:32
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_XDLHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 30ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT '1ffad810-053e-4d8b-1a2d-08db56bbbc2c'
	,'20230517 09:47:31.987'
	,N'NXY001'
	,N'a260be6a12c9479085e92c2ddc557726'
	,N'40HQ'
	,N'CN_RMLHK'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 700.00000000000000000000
Wave using tariff: 700.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 700.00000000000000000000
Wave using tariff: 700.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 700.00; Costs: 700.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,12
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,700.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 5ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_RMLHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 25ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_RMLHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 45ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT '74345d51-3196-4d7e-9068-08db56bbbc22'
	,'20230517 09:47:31.893'
	,N'NXY001'
	,N'94ceb75f04c04940aafc6b87c8b7f1c1'
	,N'40HQ'
	,N'CN_OETHK'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 770.00000000000000000000
Wave using tariff: 770.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 770.00000000000000000000
Wave using tariff: 770.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 770.00; Costs: 770.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,11
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,770.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 5ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_OETHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 21ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_OETHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 30ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT '1b97370d-db8b-451c-4257-08db56bbbc14'
	,'20230517 09:47:31.815'
	,N'NXY001'
	,N'aac2d069f13b407d8ae5a5fb3a9f50c7'
	,N'40HQ'
	,N'CN_JXDHK'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 701.00000000000000000000
Wave using tariff: 701.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 701.00000000000000000000
Wave using tariff: 701.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 701.00; Costs: 701.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,10
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,701.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 6ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_JXDHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 23ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_JXDHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 44ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT '23f393c2-f951-4ee6-321a-08db56bbbc01'
	,'20230517 09:47:31.721'
	,N'NXY001'
	,N'b2973f4720ed4579ae3fdf7e0ec6229f'
	,N'40HQ'
	,N'CN_JHE'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 723.00000000000000000000
Wave using tariff: 723.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 723.00000000000000000000
Wave using tariff: 723.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 723.00; Costs: 723.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,9
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,723.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 22ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_JHE'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 23ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_JHE'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 67ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT 'b53a43ac-e01b-4c17-e206-08db56bbbbf2'
	,'20230517 09:47:31.612'
	,N'NXY001'
	,N'091df0f64cc142b0a796f1349d435471'
	,N'40HQ'
	,N'CN_HTG'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 700.00000000000000000000
Wave using tariff: 700.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 700.00000000000000000000
Wave using tariff: 700.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 700.00; Costs: 700.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,8
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,700.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 5ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_HTG'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 31ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_HTG'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 46ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT 'e15a9c82-471c-45dc-9305-08db56bbbbe4'
	,'20230517 09:47:31.503'
	,N'NXY001'
	,N'af887c8b8c4b461faf9d767f6fdfa6c0'
	,N'40HQ'
	,N'CN_HSJ'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 701.00000000000000000000
Wave using tariff: 701.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 701.00000000000000000000
Wave using tariff: 701.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 701.00; Costs: 701.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,7
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,701.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 5ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_HSJ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 25ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_HSJ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 47ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT '88dee6d6-18da-4ba5-e24b-08db56bbbbd3'
	,'20230517 09:47:31.409'
	,N'NXY001'
	,N'70a272a4c6ae4dd7b89fe46af82564e1'
	,N'40HQ'
	,N'CN_HHL'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 750.00000000000000000000
Wave using tariff: 750.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 750.00000000000000000000
Wave using tariff: 750.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 750.00; Costs: 750.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,6
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,750.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 5ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_HHL'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 22ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_HHL'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 66ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT 'c14fb8bb-f274-4465-320f-08db56bbbbc3'
	,'20230517 09:47:31.284'
	,N'NXY001'
	,N'3bd8be9eb54d46daafe723c94ae79279'
	,N'40HQ'
	,N'CN_HDEHK'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 672.00000000000000000000
Wave using tariff: 672.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 672.00000000000000000000
Wave using tariff: 672.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 672.00; Costs: 672.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,5
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,672.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 20ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_HDEHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 24ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_HDEHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 47ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT 'eeb1b318-4a72-4835-8187-08db56bbbbb2'
	,'20230517 09:47:31.190'
	,N'NXY001'
	,N'c59715b9781540d68a2863c0eec7bb7c'
	,N'40HQ'
	,N'CN_GTLHK'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 675.00000000000000000000
Wave using tariff: 675.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 675.00000000000000000000
Wave using tariff: 675.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 675.00; Costs: 675.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,4
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,675.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 5ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_GTLHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 25ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_GTLHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 63ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT '4dab6735-ee0a-466a-3441-08db56bbbba4'
	,'20230517 09:47:31.081'
	,N'NXY001'
	,N'99a80b0987604089bbea4cbacef64780'
	,N'40HQ'
	,N'CN_FUTHK'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 772.00000000000000000000
Wave using tariff: 772.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 772.00000000000000000000
Wave using tariff: 772.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 772.00; Costs: 772.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,3
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,772.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 5ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_FUTHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 27ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_FUTHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 35ms
--2023-05-17 09:47:31
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT 'dae033ab-ed6b-421f-e589-08db56bbbb95'
	,'20230517 09:47:31.003'
	,N'NXY001'
	,N'e7816ba034554bcfaed4d1096fe94e10'
	,N'40HQ'
	,N'CN_DXTHK'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 691.00000000000000000000
Wave using tariff: 691.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 691.00000000000000000000
Wave using tariff: 691.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 691.00; Costs: 691.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,2
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,691.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 5ms
--2023-05-17 09:47:31
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_DXTHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 23ms
--2023-05-17 09:47:30
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_DXTHK'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 58ms
--2023-05-17 09:47:30
INSERT INTO BundlePossibilities (
	[IDBundlePossibility]
	,[BundlePossibilityAddDateTime]
	,[BundlePossibilityAddUserCode]
	,[BundlePossibilityBundleID]
	,[CarrierThresholdType]
	,[CompanyIDCarrier]
	,[BundlePossibilityCostDebugInfo]
	,[BundlePossibilityCostInfo]
	,[BundlePossibilityCostsAreOK]
	,[BundlePossibilityInfo]
	,[PalletTypeCode]
	,[BundlePossibilityPossibilityID]
	,[BundlePossibilityRevenueDebugInfo]
	,[BundlePossibilityRevenueInfo]
	,[BundlePossibilityRevenueIsOK]
	,[BundlePossibilitySessionID]
	,[BundlePossibilityStopFinancialsStorageString]
	,[BundlePossibilityTotalCosts]
	,[BundlePossibilityTotalRevenue]
	,[TransportID]
	,[BundlePossibilityValue]
	)
SELECT 'adbfe5c9-d2f1-4030-9c5b-08db56bbbb0b'
	,'20230517 09:47:30.878'
	,N'NXY001'
	,N'b092b86790044e3ba92900c19da109f2'
	,N'40HQ'
	,N'CN_CYI'
	,N'Charge: Trucking(拖车费)(auto-calculated)Transport:
Found tariff in matrix for regions LOG to YANTIAN: 784.00000000000000000000
Wave using tariff: 784.00000000000000000000
Quantity is tariff found in matrix
Transport:
Found tariff in matrix for regions LOG to YANTIAN: 784.00000000000000000000
Wave using tariff: 784.00000000000000000000
Quantity is tariff found in matrix'
	,N'Charge: Trucking(拖车费)(auto-calculated)
Quantity: 784.00; Costs: 784.00
Region LOG to YANTIAN: No items found in transport matrix'
	,0
	,NULL
	,N'ContainerTruck'
	,1
	,NULL
	,N'No matching charges found'
	,0
	,'6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'
	,NULL
	,784.00000000000000000000000000
	,0
	,'0273339f-86ad-43ae-37d7-08dae6f3be3f'
	,0

--Duration: 21ms
--2023-05-17 09:47:30
SELECT [Charge].IDCharge AS [ID]
	,[Charge].ChargeAddDateTime AS [AddDateTime]
	,[Charge].ChargeAddUserCode AS [AddUserCode]
	,[Charge].ChargeAlwaysUseClientSpecificTariffFromMatrix AS [AlwaysUseClientSpecificTariffFromMatrix]
	,[Charge].ChargeBookDateField AS [BookDateField]
	,[Charge].ChargeCalculationDay AS [CalculationDay]
	,[Charge].ChargeCategoryID AS [CategoryID]
	,[Charge].ChargeCostsFromSupplier AS [CostsFromSupplier]
	,[Charge].CountryCode AS [CountryCode]
	,[Charge].ChargeCriteriaString AS [CriteriaString]
	,[Charge].ChargeDefaultAllocationMethod AS [DefaultAllocationMethod]
	,[Charge].ChargeDefaultTariff AS [DefaultTariff]
	,[Charge].ChargeDescription AS [Description]
	,[Charge].ChargeDirectAmount AS [DirectAmount]
	,[Charge].ChargeDirectForCustomers AS [DirectForCustomers]
	,[Charge].ChargeDisplayName AS [DisplayName]
	,[Charge].ChargeDontSendCostToFinancialSystem AS [DontSendCostToFinancialSystem]
	,[Charge].ChargeDontSendIncomeToFinancialSystem AS [DontSendIncomeToFinancialSystem]
	,[Charge].ChargeEditDateTime AS [EditDateTime]
	,[Charge].ChargeEditUserCode AS [EditUserCode]
	,[Charge].ChargeExternalID AS [ExternalID]
	,[Charge].ChargeExternalMeasuringUnit AS [ExternalMeasuringUnit]
	,[Charge].ChargeExternalUserChargeDescription AS [ExternalUserChargeDescription]
	,[Charge].ChargeExternalUserGroupDescription AS [ExternalUserGroupDescription]
	,[Charge].ChargeExternalUserWizardPage AS [ExternalUserWizardPage]
	,[Charge].ChargeFreeQuantity AS [FreeQuantity]
	,[Charge].ChargeGroupID AS [GroupID]
	,[Charge].ChargeGroupNumber AS [GroupNumber]
	,[Charge].ChargeIgnoreForOptimization AS [IgnoreForOptimization]
	,[Charge].ChargeInvoiceWithoutQuantity AS [InvoiceWithoutQuantity]
	,[Charge].ChargeLegNumber AS [LegNumber]
	,[Charge].ChargeMatrixDestinationSearchField AS [MatrixDestinationSearchField]
	,[Charge].ChargeMatrixFigureRoundingType AS [MatrixFigureRoundingType]
	,[Charge].ChargeMatrixOriginSearchField AS [MatrixOriginSearchField]
	,[Charge].ChargeMatrixSearchFigureExpression AS [MatrixSearchFigureExpression]
	,[Charge].ChargeMatrixSearchFigureType AS [MatrixSearchFigureType]
	,[Charge].ChargeMatrixSearchRoundingType AS [MatrixSearchRoundingType]
	,[Charge].ChargeMatrixTariffFigureExpression AS [MatrixTariffFigureExpression]
	,[Charge].ChargeMatrixTariffFigureType AS [MatrixTariffFigureType]
	,[Charge].ChargeMeasuringUnit AS [MeasuringUnit]
	,[Charge].ChargeMeasuringUnitName AS [MeasuringUnitName]
	,[Charge].ChargeMinimumQuantityType AS [MinimumQuantityType]
	,[Charge].ChargeMultiplyQuantityWithSplitQuantity AS [MultiplyQuantityWithSplitQuantity]
	,[Charge].ChargeName AS [Name]
	,[Charge].ChargeOnlyUseFirstItemFromFirstMatrix AS [OnlyUseFirstItemFromFirstMatrix]
	,[Charge].ChargeOrderBundleUsage AS [OrderBundleUsage]
	,[Charge].ChargeOrderNumber AS [OrderNumber]
	,[Charge].ChargeOrderUsage AS [OrderUsage]
	,[Charge].ChargeQuotationUsage AS [QuotationUsage]
	,[Charge].ChargeReadOnlyForInternalUsers AS [ReadOnlyForInternalUsers]
	,[Charge].ChargeReceiptBundleUsage AS [ReceiptBundleUsage]
	,[Charge].ChargeReceiptUsage AS [ReceiptUsage]
	,[Charge].ChargeReportingName AS [ReportingName]
	,[Charge].ChargeRequiresActivation AS [RequiresActivation]
	,[Charge].ChargeRoundingType AS [RoundingType]
	,[Charge].ScoreCardCategoryID AS [ScoreCardCategoryID]
	,[Charge].ChargeShortName AS [ShortName]
	,[Charge].ChargeSourceSystemID AS [SourceSystemID]
	,[Charge].ChargeSpecialType AS [SpecialType]
	,[Charge].ChargeSplitType AS [SplitType]
	,[Charge].ChargeTransportDetailUsage AS [TransportDetailUsage]
	,[Charge].TransportStopUsage AS [TransportStopUsage]
	,[Charge].ChargeTransportUsage AS [TransportUsage]
	,[Charge].ChargeType AS [Type]
	,[Charge].ChargeUseMatrixFigureAsFigure AS [UseMatrixFigureAsFigure]
	,[Charge].ChargeUseMaximumTariffFromMatrix AS [UseMaximumTariffFromMatrix]
	,[Charge].ChargeValueNumberFormat AS [ValueNumberFormat]
	,[Charge].ChargeVisibleToExternalUsers AS [VisibleToExternalUsers]
FROM Charges [Charge] WITH (NOLOCK)
WHERE [Charge].IDCharge = 'ea5d047b-7261-456b-bddb-52eafc043b34'

--Duration: 1ms
--2023-05-17 09:47:30
SELECT [Charge].IDCharge AS [ID]
	,[Charge].ChargeAddDateTime AS [AddDateTime]
	,[Charge].ChargeAddUserCode AS [AddUserCode]
	,[Charge].ChargeAlwaysUseClientSpecificTariffFromMatrix AS [AlwaysUseClientSpecificTariffFromMatrix]
	,[Charge].ChargeBookDateField AS [BookDateField]
	,[Charge].ChargeCalculationDay AS [CalculationDay]
	,[Charge].ChargeCategoryID AS [CategoryID]
	,[Charge].ChargeCostsFromSupplier AS [CostsFromSupplier]
	,[Charge].CountryCode AS [CountryCode]
	,[Charge].ChargeCriteriaString AS [CriteriaString]
	,[Charge].ChargeDefaultAllocationMethod AS [DefaultAllocationMethod]
	,[Charge].ChargeDefaultTariff AS [DefaultTariff]
	,[Charge].ChargeDescription AS [Description]
	,[Charge].ChargeDirectAmount AS [DirectAmount]
	,[Charge].ChargeDirectForCustomers AS [DirectForCustomers]
	,[Charge].ChargeDisplayName AS [DisplayName]
	,[Charge].ChargeDontSendCostToFinancialSystem AS [DontSendCostToFinancialSystem]
	,[Charge].ChargeDontSendIncomeToFinancialSystem AS [DontSendIncomeToFinancialSystem]
	,[Charge].ChargeEditDateTime AS [EditDateTime]
	,[Charge].ChargeEditUserCode AS [EditUserCode]
	,[Charge].ChargeExternalID AS [ExternalID]
	,[Charge].ChargeExternalMeasuringUnit AS [ExternalMeasuringUnit]
	,[Charge].ChargeExternalUserChargeDescription AS [ExternalUserChargeDescription]
	,[Charge].ChargeExternalUserGroupDescription AS [ExternalUserGroupDescription]
	,[Charge].ChargeExternalUserWizardPage AS [ExternalUserWizardPage]
	,[Charge].ChargeFreeQuantity AS [FreeQuantity]
	,[Charge].ChargeGroupID AS [GroupID]
	,[Charge].ChargeGroupNumber AS [GroupNumber]
	,[Charge].ChargeIgnoreForOptimization AS [IgnoreForOptimization]
	,[Charge].ChargeInvoiceWithoutQuantity AS [InvoiceWithoutQuantity]
	,[Charge].ChargeLegNumber AS [LegNumber]
	,[Charge].ChargeMatrixDestinationSearchField AS [MatrixDestinationSearchField]
	,[Charge].ChargeMatrixFigureRoundingType AS [MatrixFigureRoundingType]
	,[Charge].ChargeMatrixOriginSearchField AS [MatrixOriginSearchField]
	,[Charge].ChargeMatrixSearchFigureExpression AS [MatrixSearchFigureExpression]
	,[Charge].ChargeMatrixSearchFigureType AS [MatrixSearchFigureType]
	,[Charge].ChargeMatrixSearchRoundingType AS [MatrixSearchRoundingType]
	,[Charge].ChargeMatrixTariffFigureExpression AS [MatrixTariffFigureExpression]
	,[Charge].ChargeMatrixTariffFigureType AS [MatrixTariffFigureType]
	,[Charge].ChargeMeasuringUnit AS [MeasuringUnit]
	,[Charge].ChargeMeasuringUnitName AS [MeasuringUnitName]
	,[Charge].ChargeMinimumQuantityType AS [MinimumQuantityType]
	,[Charge].ChargeMultiplyQuantityWithSplitQuantity AS [MultiplyQuantityWithSplitQuantity]
	,[Charge].ChargeName AS [Name]
	,[Charge].ChargeOnlyUseFirstItemFromFirstMatrix AS [OnlyUseFirstItemFromFirstMatrix]
	,[Charge].ChargeOrderBundleUsage AS [OrderBundleUsage]
	,[Charge].ChargeOrderNumber AS [OrderNumber]
	,[Charge].ChargeOrderUsage AS [OrderUsage]
	,[Charge].ChargeQuotationUsage AS [QuotationUsage]
	,[Charge].ChargeReadOnlyForInternalUsers AS [ReadOnlyForInternalUsers]
	,[Charge].ChargeReceiptBundleUsage AS [ReceiptBundleUsage]
	,[Charge].ChargeReceiptUsage AS [ReceiptUsage]
	,[Charge].ChargeReportingName AS [ReportingName]
	,[Charge].ChargeRequiresActivation AS [RequiresActivation]
	,[Charge].ChargeRoundingType AS [RoundingType]
	,[Charge].ScoreCardCategoryID AS [ScoreCardCategoryID]
	,[Charge].ChargeShortName AS [ShortName]
	,[Charge].ChargeSourceSystemID AS [SourceSystemID]
	,[Charge].ChargeSpecialType AS [SpecialType]
	,[Charge].ChargeSplitType AS [SplitType]
	,[Charge].ChargeTransportDetailUsage AS [TransportDetailUsage]
	,[Charge].TransportStopUsage AS [TransportStopUsage]
	,[Charge].ChargeTransportUsage AS [TransportUsage]
	,[Charge].ChargeType AS [Type]
	,[Charge].ChargeUseMatrixFigureAsFigure AS [UseMatrixFigureAsFigure]
	,[Charge].ChargeUseMaximumTariffFromMatrix AS [UseMaximumTariffFromMatrix]
	,[Charge].ChargeValueNumberFormat AS [ValueNumberFormat]
	,[Charge].ChargeVisibleToExternalUsers AS [VisibleToExternalUsers]
FROM Charges [Charge] WITH (NOLOCK)
WHERE [Charge].IDCharge = 'ea5d047b-7261-456b-bddb-52eafc043b34'

--Duration: 3ms
--2023-05-17 09:47:30
SELECT [RatesOfExchange].CurrencyCode AS [CurrencyCode]
	,[RatesOfExchange].RateOfExchangeFromDate AS [FromDate]
	,[RatesOfExchange].RateOfExchangeAddDateTime AS [AddDateTime]
	,[RatesOfExchange].RateOfExchangeAddUserCode AS [AddUserCode]
	,[RatesOfExchange].RateOfExchangeEditDateTime AS [EditDateTime]
	,[RatesOfExchange].RateOfExchangeEditUserCode AS [EditUserCode]
	,[RatesOfExchange].RateOfExchangeRate AS [Rate]
	,[RatesOfExchange].RateOfExchangeToDate AS [ToDate]
FROM RatesOfExchange WITH (NOLOCK)
WHERE [RatesOfExchange].RateOfExchangeFromDate <= '20221231'
	AND (
		[RatesOfExchange].RateOfExchangeToDate > '20221231'
		OR [RatesOfExchange].RateOfExchangeToDate IS NULL
		)
	AND [RatesOfExchange].CurrencyCode = N'HKD'

--Duration: 2ms
--2023-05-17 09:47:30
SELECT [Currency].CurrencyCode AS [Code]
	,[Currency].CurrencyAddDateTime AS [AddDateTime]
	,[Currency].CurrencyAddUserCode AS [AddUserCode]
	,[Currency].CurrencyDefaultRateOfExchange AS [DefaultRateOfExchange]
	,[Currency].CurrencyEditDateTime AS [EditDateTime]
	,[Currency].CurrencyEditUserCode AS [EditUserCode]
FROM Currencies [Currency] WITH (NOLOCK)
WHERE [Currency].CurrencyCode = N'CNY'

--Duration: 39ms
--2023-05-17 09:47:30
SELECT [RatesOfExchange].CurrencyCode AS [CurrencyCode]
	,[RatesOfExchange].RateOfExchangeFromDate AS [FromDate]
	,[RatesOfExchange].RateOfExchangeAddDateTime AS [AddDateTime]
	,[RatesOfExchange].RateOfExchangeAddUserCode AS [AddUserCode]
	,[RatesOfExchange].RateOfExchangeEditDateTime AS [EditDateTime]
	,[RatesOfExchange].RateOfExchangeEditUserCode AS [EditUserCode]
	,[RatesOfExchange].RateOfExchangeRate AS [Rate]
	,[RatesOfExchange].RateOfExchangeToDate AS [ToDate]
FROM RatesOfExchange WITH (NOLOCK)
WHERE [RatesOfExchange].RateOfExchangeFromDate <= '20221231'
	AND (
		[RatesOfExchange].RateOfExchangeToDate > '20221231'
		OR [RatesOfExchange].RateOfExchangeToDate IS NULL
		)
	AND [RatesOfExchange].CurrencyCode = N'CNY'

--Duration: 29ms
--2023-05-17 09:47:30
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'TruckingHKD'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_CYI'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 29ms
--2023-05-17 09:47:30
SELECT TOP 1 [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode AS [RegionCode]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) AS [RegionCodeLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin AS [RegionCodeOrigin]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodeOriginLength]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin AS [Origin]
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination AS [Destination]
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) AS [RegionCodesTotalLength]
	,MAX([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMinimumAmount) AS [MinimumAmount]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemTariff) AS [Tariff]
	,MIN(CASE 
			WHEN CompanyRateChargeTransportMatrixItems.SubContextCode IS NOT NULL
				THEN CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemTariff
			END) AS [ClientDependentTariff]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemInfo) AS [Info]
	,MIN([CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemMaximumAmount) AS [MaximumAmount]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference = N'Trucking'
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND (
		(
			(
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases >= 1.00000000000000000000
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets >= 0
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
				)
			AND (
				[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NOT NULL
				OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NOT NULL
				)
			)
		OR (
			[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemWeight IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemVolume IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemPallets IS NULL
			AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemCases IS NULL
			)
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin = N'CN_PRSOCE_000019773'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination = N'CN_ShenzhenYATLP'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination IS NULL
		)
	AND (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyIDSupplier = N'CN_CYI'
		OR [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCodeOrigin
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, ''))
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemOrigin DESC
	,[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemDestination DESC
	,LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode, '')) + LEN(ISNULL(CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin, '')) DESC

--Duration: 84ms
--2023-05-17 09:47:30
SELECT [Charges].IDCharge AS [ID]
	,[Charges].ChargeAddDateTime AS [AddDateTime]
	,[Charges].ChargeAddUserCode AS [AddUserCode]
	,[Charges].ChargeAlwaysUseClientSpecificTariffFromMatrix AS [AlwaysUseClientSpecificTariffFromMatrix]
	,[Charges].ChargeBookDateField AS [BookDateField]
	,[Charges].ChargeCalculationDay AS [CalculationDay]
	,[Charges].ChargeCategoryID AS [CategoryID]
	,[Charges].ChargeCostsFromSupplier AS [CostsFromSupplier]
	,[Charges].CountryCode AS [CountryCode]
	,[Charges].ChargeCriteriaString AS [CriteriaString]
	,[Charges].ChargeDefaultAllocationMethod AS [DefaultAllocationMethod]
	,[Charges].ChargeDefaultTariff AS [DefaultTariff]
	,[Charges].ChargeDescription AS [Description]
	,[Charges].ChargeDirectAmount AS [DirectAmount]
	,[Charges].ChargeDirectForCustomers AS [DirectForCustomers]
	,[Charges].ChargeDisplayName AS [DisplayName]
	,[Charges].ChargeDontSendCostToFinancialSystem AS [DontSendCostToFinancialSystem]
	,[Charges].ChargeDontSendIncomeToFinancialSystem AS [DontSendIncomeToFinancialSystem]
	,[Charges].ChargeEditDateTime AS [EditDateTime]
	,[Charges].ChargeEditUserCode AS [EditUserCode]
	,[Charges].ChargeExternalID AS [ExternalID]
	,[Charges].ChargeExternalMeasuringUnit AS [ExternalMeasuringUnit]
	,[Charges].ChargeExternalUserChargeDescription AS [ExternalUserChargeDescription]
	,[Charges].ChargeExternalUserGroupDescription AS [ExternalUserGroupDescription]
	,[Charges].ChargeExternalUserWizardPage AS [ExternalUserWizardPage]
	,[Charges].ChargeFreeQuantity AS [FreeQuantity]
	,[Charges].ChargeGroupID AS [GroupID]
	,[Charges].ChargeGroupNumber AS [GroupNumber]
	,[Charges].ChargeIgnoreForOptimization AS [IgnoreForOptimization]
	,[Charges].ChargeInvoiceWithoutQuantity AS [InvoiceWithoutQuantity]
	,[Charges].ChargeLegNumber AS [LegNumber]
	,[Charges].ChargeMatrixDestinationSearchField AS [MatrixDestinationSearchField]
	,[Charges].ChargeMatrixFigureRoundingType AS [MatrixFigureRoundingType]
	,[Charges].ChargeMatrixOriginSearchField AS [MatrixOriginSearchField]
	,[Charges].ChargeMatrixSearchFigureExpression AS [MatrixSearchFigureExpression]
	,[Charges].ChargeMatrixSearchFigureType AS [MatrixSearchFigureType]
	,[Charges].ChargeMatrixSearchRoundingType AS [MatrixSearchRoundingType]
	,[Charges].ChargeMatrixTariffFigureExpression AS [MatrixTariffFigureExpression]
	,[Charges].ChargeMatrixTariffFigureType AS [MatrixTariffFigureType]
	,[Charges].ChargeMeasuringUnit AS [MeasuringUnit]
	,[Charges].ChargeMeasuringUnitName AS [MeasuringUnitName]
	,[Charges].ChargeMinimumQuantityType AS [MinimumQuantityType]
	,[Charges].ChargeMultiplyQuantityWithSplitQuantity AS [MultiplyQuantityWithSplitQuantity]
	,[Charges].ChargeName AS [Name]
	,[Charges].ChargeOnlyUseFirstItemFromFirstMatrix AS [OnlyUseFirstItemFromFirstMatrix]
	,[Charges].ChargeOrderBundleUsage AS [OrderBundleUsage]
	,[Charges].ChargeOrderNumber AS [OrderNumber]
	,[Charges].ChargeOrderUsage AS [OrderUsage]
	,[Charges].ChargeQuotationUsage AS [QuotationUsage]
	,[Charges].ChargeReadOnlyForInternalUsers AS [ReadOnlyForInternalUsers]
	,[Charges].ChargeReceiptBundleUsage AS [ReceiptBundleUsage]
	,[Charges].ChargeReceiptUsage AS [ReceiptUsage]
	,[Charges].ChargeReportingName AS [ReportingName]
	,[Charges].ChargeRequiresActivation AS [RequiresActivation]
	,[Charges].ChargeRoundingType AS [RoundingType]
	,[Charges].ScoreCardCategoryID AS [ScoreCardCategoryID]
	,[Charges].ChargeShortName AS [ShortName]
	,[Charges].ChargeSourceSystemID AS [SourceSystemID]
	,[Charges].ChargeSpecialType AS [SpecialType]
	,[Charges].ChargeSplitType AS [SplitType]
	,[Charges].ChargeTransportDetailUsage AS [TransportDetailUsage]
	,[Charges].TransportStopUsage AS [TransportStopUsage]
	,[Charges].ChargeTransportUsage AS [TransportUsage]
	,[Charges].ChargeType AS [Type]
	,[Charges].ChargeUseMatrixFigureAsFigure AS [UseMatrixFigureAsFigure]
	,[Charges].ChargeUseMaximumTariffFromMatrix AS [UseMaximumTariffFromMatrix]
	,[Charges].ChargeValueNumberFormat AS [ValueNumberFormat]
	,[Charges].ChargeVisibleToExternalUsers AS [VisibleToExternalUsers]
FROM Charges WITH (NOLOCK)
WHERE [Charges].IDCharge = 'ea5d047b-7261-456b-bddb-52eafc043b34'

--Duration: 18ms
--2023-05-17 09:47:30
SELECT [CompanyRateChargeTariffs].IDCompanyRateChargeTariff AS [ID]
	,[CompanyRateChargeTariffs].CompanyRateChargeTariffAddDateTime AS [AddDateTime]
	,[CompanyRateChargeTariffs].CompanyRateChargeTariffAddUserCode AS [AddUserCode]
	,[CompanyRateChargeTariffs].CompanyRateChargeID AS [CompanyRateChargeID]
	,[CompanyRateChargeTariffs].CompanyRateChargeTariffEditDateTime AS [EditDateTime]
	,[CompanyRateChargeTariffs].CompanyRateChargeTariffEditUserCode AS [EditUserCode]
	,[CompanyRateChargeTariffs].CompanyRateChargeTariffFrom AS [From]
	,[CompanyRateChargeTariffs].CompanyRateChargeTariffTo AS [To]
	,[CompanyRateChargeTariffs].CompanyRateChargeTariffValuePurchase AS [ValuePurchase]
	,[CompanyRateChargeTariffs].CompanyRateChargeTariffValue AS [ValueSales]
FROM CompanyRateChargeTariffs WITH (NOLOCK)
WHERE [CompanyRateChargeTariffs].CompanyRateChargeID IN (
		'5304bfd1-2a59-4efd-049e-08d47cc7d70f'
		,'3b140d60-d55d-4e6a-d965-08d47cc7d710'
		,'dd3f4124-123e-49bf-2ecc-08d2bf09bd57'
		,'efba8d9e-e01e-4d8a-1d3b-08d1cd272857'
		,'472ad3d4-d2c7-479f-dcc0-08d1c88493b4'
		)

--Duration: 59ms
--2023-05-17 09:47:30
SELECT [CompanyRateCharges].IDCompanyRateCharge AS [ID]
	,[CompanyRateCharges].CompanyRateChargeAddDateTime AS [AddDateTime]
	,[CompanyRateCharges].CompanyRateChargeAddUserCode AS [AddUserCode]
	,[CompanyRateCharges].CompanyRateChargeAutomaticCopyCostToIncome AS [AutomaticCopyCostToIncome]
	,[CompanyRateCharges].ChargeID AS [ChargeID]
	,[CompanyRateCharges].CompanyID AS [CompanyID]
	,[CompanyRateCharges].CompanyRateValidFromDate AS [CompanyRateValidFromDate]
	,[CompanyRateCharges].CompanyRateChargeComplexRevenueCalculation AS [ComplexRevenueCalculation]
	,[CompanyRateCharges].CompanyRateChargeCostsForConsigneeType AS [CostsForConsigneeType]
	,[CompanyRateCharges].CurrencyCode AS [CurrencyCode]
	,[CompanyRateCharges].CompanyRateChargeDefaultAllocationMethod AS [DefaultAllocationMethod]
	,[CompanyRateCharges].CompanyRateChargeDefaultMarginFactor AS [DefaultMarginFactor]
	,[CompanyRateCharges].CompanyRateChargeDefaultPaymentParty AS [DefaultPaymentParty]
	,[CompanyRateCharges].CompanyRateChargeDefaultVATCodeCost AS [DefaultVATCodeCost]
	,[CompanyRateCharges].CompanyRateChargeDefaultVATCodeIncome AS [DefaultVATCodeIncome]
	,[CompanyRateCharges].DepartmentCode AS [DepartmentCode]
	,[CompanyRateCharges].CompanyRateChargeEditDateTime AS [EditDateTime]
	,[CompanyRateCharges].CompanyRateChargeEditUserCode AS [EditUserCode]
	,[CompanyRateCharges].CompanyRateChargeExternalCustomerID AS [ExternalCustomerID]
	,[CompanyRateCharges].CompanyRateChargeGroupNumber AS [GroupNumber]
	,[CompanyRateCharges].CompanyRateChargeHideForInboundPurchase AS [HideForInboundPurchase]
	,[CompanyRateCharges].CompanyRateChargeHideForInboundSales AS [HideForInboundSales]
	,[CompanyRateCharges].CompanyRateChargeHideForOutboundPurchase AS [HideForOutboundPurchase]
	,[CompanyRateCharges].CompanyRateChargeHideForOutboundSales AS [HideForOutboundSales]
	,[CompanyRateCharges].CompanyRateChargeInputInstructions AS [InputInstructions]
	,[CompanyRateCharges].CompanyRateChargeMarginFactor AS [MarginFactor]
	,[CompanyRateCharges].CompanyRateChargeMaximumRevenue AS [MaximumRevenue]
	,[CompanyRateCharges].CompanyRateChargeMaximumRevenueGrouping AS [MaximumRevenueGrouping]
	,[CompanyRateCharges].CompanyRateChargeMinimumQuantity AS [MinimumQuantity]
	,[CompanyRateCharges].CompanyRateChargeMinimumQuantityAllocationShare AS [MinimumQuantityAllocationShare]
	,[CompanyRateCharges].CompanyRateChargeMinimumQuantityCorrectionRatePurchase AS [MinimumQuantityCorrectionRatePurchase]
	,[CompanyRateCharges].CompanyRateChargeMinimumQuantityCorrectionRate AS [MinimumQuantityCorrectionRateSales]
	,[CompanyRateCharges].CompanyRateChargePaymentTermCode AS [PaymentTermCode]
	,[CompanyRateCharges].CompanyRateChargeRemarks AS [Remarks]
	,[CompanyRateCharges].SubChargeIDDefault AS [SubChargeIDDefault]
	,[CompanyRateCharges].CompanyRateChargeTransportMatrixReference AS [TransportMatrixReference]
	,[CompanyRateCharges].CompanyRateChargeTransportMatrixReference2 AS [TransportMatrixReference2]
	,[CompanyRateCharges].CompanyRateChargeTransportMatrixReferenceSupplierLink AS [TransportMatrixReferenceSupplierLink]
FROM CompanyRateCharges WITH (NOLOCK)
LEFT JOIN Charges [CompanyRateCharges_Charge] WITH (NOLOCK) ON CompanyRateCharges.ChargeID = CompanyRateCharges_Charge.IDCharge
WHERE [CompanyRateCharges].CompanyID IN (
		N'CN_PRSOCE'
		,N'BILLING_ALL'
		)
	AND [CompanyRateCharges_Charge].ChargeMeasuringUnit IN (
		N'NumberOfTransports'
		,N'TransportMatrixOnWaveFigure'
		,N'TransportMatrixOnTransportFigure'
		,N'TransportedCartons'
		,N'TransportedPallets'
		,N'TransportMatrix'
		,N'TransportWaitingTime'
		,N'NumberOfTransportStops'
		,N'BilledQuantity'
		,N'BilledRevenueLocalCurrency'
		,N'BilledCostLocalCurrency'
		,N'BilledRevenueLocalCurrenyQuotationMatrix'
		)
	AND [CompanyRateCharges_Charge].ChargeIgnoreForOptimization = 0

--Duration: 220ms
--2023-05-17 09:47:30
SELECT [CompanyRates].CompanyID AS [CompanyID]
	,[CompanyRates].CompanyRateValidFromDate AS [ValidFromDate]
	,[CompanyRates].CompanyRateActive AS [Active]
	,[CompanyRates].CompanyRateAddDateTime AS [AddDateTime]
	,[CompanyRates].CompanyRateAddUserCode AS [AddUserCode]
	,[CompanyRates].CompanyRateDefaultCurrencyCode AS [DefaultCurrencyCode]
	,[CompanyRates].CompanyRateDivision AS [Division]
	,[CompanyRates].CompanyRateEditDateTime AS [EditDateTime]
	,[CompanyRates].CompanyRateEditUserCode AS [EditUserCode]
	,[CompanyRates].CompanyRateExternalCustomerID AS [ExternalCustomerID]
	,[CompanyRates].CompanyRateInvoiceNumberPrefix AS [InvoiceNumberPrefix]
	,[CompanyRates].CompanyRatePaymentTermCode AS [PaymentTermCode]
	,[CompanyRates].CompanyRateRemarks AS [Remarks]
	,[CompanyRates].CompanyRateUsesOrderScreen AS [UsesOrderScreen]
	,[CompanyRates].CompanyRateUsesReceiptScreen AS [UsesReceiptScreen]
	,[CompanyRates].CompanyRateUsesTransportScreen AS [UsesTransportScreen]
FROM CompanyRates WITH (NOLOCK)
WHERE [CompanyRates].CompanyID IN (
		N'CN_PRSOCE'
		,N'BILLING_ALL'
		)

--Duration: 40ms
--2023-05-17 09:47:30
DELETE BundlePossibilities
FROM BundlePossibilities WITH (NOLOCK)
WHERE [BundlePossibilities].BundlePossibilitySessionID = '6a5c5e5a-cd9c-45fa-9e1e-bacb600e1e88'

--Duration: 145ms
--2023-05-17 09:47:29
SELECT [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference AS [TransportMatrixReference]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NOT NULL
GROUP BY [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixReference

--Duration: 1985ms
--2023-05-17 09:47:27
SELECT [TransportDetails].IDTransportDetail AS [ID]
	,[TransportDetails].TransportDetailActualDateTimeOfArrival AS [ActualDateTimeOfArrival]
	,[TransportDetails].TransportDetailActualDateTimeOfDeparture AS [ActualDateTimeOfDeparture]
	,[TransportDetails].TransportDetailAddDateTime AS [AddDateTime]
	,[TransportDetails].TransportDetailAdditionalVolume AS [AdditionalVolume]
	,[TransportDetails].TransportDetailAddUserCode AS [AddUserCode]
	,[TransportDetails].TransportDetailCartons AS [Cartons]
	,[TransportDetails].TransportDetailCBLNumber AS [CBLNumber]
	,[TransportDetails].TransportDetailClientReference AS [ClientReference]
	,[TransportDetails].TransportDetailColliWeight AS [ColliWeight]
	,[TransportDetails].CompanyIDSupplier AS [CompanyIDSupplier]
	,[TransportDetails].TransportDetailConsigneeCompanyID AS [ConsigneeCompanyID]
	,[TransportDetails].TransportDetailCSNumber AS [CSNumber]
	,[TransportDetails].TransportDetailCSSequence AS [CSSequence]
	,[TransportDetails].TransportDetailCustomsConfirmed AS [CustomsConfirmed]
	,[TransportDetails].TransportDetailDeliveryCompanyID AS [DeliveryCompanyID]
	,[TransportDetails].TransportDetailDeliveryContact AS [DeliveryContact]
	,[TransportDetails].TransportDetailDeliveryDateTime AS [DeliveryDateTime]
	,[TransportDetails].TransportDetailDepth AS [Depth]
	,[TransportDetails].TransportDetailDocumentReference AS [DocumentReference]
	,[TransportDetails].TransportDetailEditDateTime AS [EditDateTime]
	,[TransportDetails].TransportDetailEditUserCode AS [EditUserCode]
	,[TransportDetails].TransportDetailEquipmentNumber AS [EquipmentNumber]
	,[TransportDetails].TransportDetailEquipmentSize AS [EquipmentSize]
	,[TransportDetails].TransportDetailEquipmentType AS [EquipmentType]
	,[TransportDetails].TransportDetailEstimatedDateTimeOfArrival AS [EstimatedDateTimeOfArrival]
	,[TransportDetails].TransportDetailEstimatedDateTimeOfDeparture AS [EstimatedDateTimeOfDeparture]
	,[TransportDetails].TransportDetailEstimatedPallets AS [EstimatedPallets]
	,[TransportDetails].TransportDetailGoThroughQuantity AS [GoThroughQuantity]
	,[TransportDetails].TransportDetailGoThroughUnitOfMeasure AS [GoThroughUnitOfMeasure]
	,[TransportDetails].TransportDetailHeight AS [Height]
	,[TransportDetails].IssueID AS [IssueID]
	,[TransportDetails].TransportDetailLeg AS [Leg]
	,[TransportDetails].TransportDetailLoadMetres AS [LoadMetres]
	,[TransportDetails].TransportDetailNotes AS [Notes]
	,[TransportDetails].OrderID AS [OrderID]
	,[TransportDetails].TransportDetailPallets AS [Pallets]
	,[TransportDetails].TransportDetailPalletType AS [PalletType]
	,[TransportDetails].TransportDetailPickUpCompanyID AS [PickUpCompanyID]
	,[TransportDetails].TransportDetailProductCode AS [ProductCode]
	,[TransportDetails].TransportDetailProductDescription AS [ProductDescription]
	,[TransportDetails].TransportDetailQuantity AS [Quantity]
	,[TransportDetails].ReceiptID AS [ReceiptID]
	,[TransportDetails].TransportDetailReference AS [Reference]
	,[TransportDetails].TransportDetailRegionCode AS [RegionCode]
	,[TransportDetails].TransportDetailRegionCodeOrigin AS [RegionCodeOrigin]
	,[TransportDetails].TransportDetailRequiresCustomsConfirmation AS [RequiresCustomsConfirmation]
	,[TransportDetails].ShipmentDetailID AS [ShipmentDetailID]
	,[TransportDetails].ShipmentID AS [ShipmentID]
	,[TransportDetails].ShipmentNumber AS [ShipmentNumber]
	,[TransportDetails].TransportDetailStackable AS [Stackable]
	,[TransportDetails].TransportDetailStatus AS [Status]
	,[TransportDetails].TransportDetailTemporaryEquipmentNumber AS [TemporaryEquipmentNumber]
	,[TransportDetails].TransportStopID AS [TransportStopID]
	,[TransportDetails].TransportDetailType AS [Type]
	,[TransportDetails].TransportDetailUnitOfMeasure AS [UnitOfMeasure]
	,[TransportDetails].TransportDetailUserDefinedDate01 AS [UserDefinedDate01]
	,[TransportDetails].TransportDetailUserDefinedDate02 AS [UserDefinedDate02]
	,[TransportDetails].TransportDetailUserDefinedDate03 AS [UserDefinedDate03]
	,[TransportDetails].TransportDetailUserDefinedDate04 AS [UserDefinedDate04]
	,[TransportDetails].TransportDetailUserDefinedDate05 AS [UserDefinedDate05]
	,[TransportDetails].TransportDetailUserDefinedDateTime01 AS [UserDefinedDateTime01]
	,[TransportDetails].TransportDetailUserDefinedDateTime02 AS [UserDefinedDateTime02]
	,[TransportDetails].TransportDetailUserDefinedDateTime03 AS [UserDefinedDateTime03]
	,[TransportDetails].TransportDetailUserDefinedDateTime04 AS [UserDefinedDateTime04]
	,[TransportDetails].TransportDetailUserDefinedDateTime05 AS [UserDefinedDateTime05]
	,[TransportDetails].TransportDetailUserDefinedDateTime06 AS [UserDefinedDateTime06]
	,[TransportDetails].TransportDetailUserDefinedDateTime07 AS [UserDefinedDateTime07]
	,[TransportDetails].TransportDetailUserDefinedDateTime09 AS [UserDefinedDateTime09]
	,[TransportDetails].TransportDetailUserDefinedDateTime10 AS [UserDefinedDateTime10]
	,[TransportDetails].TransportDetailUserDefinedLongText01 AS [UserDefinedLongText01]
	,[TransportDetails].TransportDetailUserDefinedLongText02 AS [UserDefinedLongText02]
	,[TransportDetails].TransportDetailUserDefinedLongText03 AS [UserDefinedLongText03]
	,[TransportDetails].TransportDetailUserDefinedLongText04 AS [UserDefinedLongText04]
	,[TransportDetails].TransportDetailUserDefinedLongText05 AS [UserDefinedLongText05]
	,[TransportDetails].TransportDetailUserDefinedNumber01 AS [UserDefinedNumber01]
	,[TransportDetails].TransportDetailUserDefinedNumber02 AS [UserDefinedNumber02]
	,[TransportDetails].TransportDetailUserDefinedNumber03 AS [UserDefinedNumber03]
	,[TransportDetails].TransportDetailUserDefinedNumber04 AS [UserDefinedNumber04]
	,[TransportDetails].TransportDetailUserDefinedNumber05 AS [UserDefinedNumber05]
	,[TransportDetails].TransportDetailUserDefinedText01 AS [UserDefinedText01]
	,[TransportDetails].TransportDetailUserDefinedText02 AS [UserDefinedText02]
	,[TransportDetails].TransportDetailUserDefinedText03 AS [UserDefinedText03]
	,[TransportDetails].TransportDetailUserDefinedText04 AS [UserDefinedText04]
	,[TransportDetails].TransportDetailUserDefinedText05 AS [UserDefinedText05]
	,[TransportDetails].TransportDetailUserDefinedText06 AS [UserDefinedText06]
	,[TransportDetails].TransportDetailUserDefinedText07 AS [UserDefinedText07]
	,[TransportDetails].TransportDetailUserDefinedText08 AS [UserDefinedText08]
	,[TransportDetails].TransportDetailUserDefinedText09 AS [UserDefinedText09]
	,[TransportDetails].TransportDetailUserDefinedText10 AS [UserDefinedText10]
	,[TransportDetails].TransportDetailUserDefinedText11 AS [UserDefinedText11]
	,[TransportDetails].TransportDetailUserDefinedText12 AS [UserDefinedText12]
	,[TransportDetails].TransportDetailUserDefinedText13 AS [UserDefinedText13]
	,[TransportDetails].TransportDetailUserDefinedText14 AS [UserDefinedText14]
	,[TransportDetails].TransportDetailUserDefinedText15 AS [UserDefinedText15]
	,[TransportDetails].TransportDetailUserDefinedYesNo01 AS [UserDefinedYesNo01]
	,[TransportDetails].TransportDetailUserDefinedYesNo02 AS [UserDefinedYesNo02]
	,[TransportDetails].TransportDetailUserDefinedYesNo03 AS [UserDefinedYesNo03]
	,[TransportDetails].TransportDetailUserDefinedYesNo04 AS [UserDefinedYesNo04]
	,[TransportDetails].TransportDetailUserDefinedYesNo05 AS [UserDefinedYesNo05]
	,[TransportDetails].TransportDetailVesselCode AS [VesselCode]
	,[TransportDetails].TransportDetailVesselName AS [VesselName]
	,[TransportDetails].TransportDetailVolume AS [Volume]
	,[TransportDetails].TransportDetailVoyageCode AS [VoyageCode]
	,[TransportDetails].TransportDetailWaveCode AS [WaveCode]
	,[TransportDetails].TransportDetailWeight AS [Weight]
	,[TransportDetails].TransportDetailWidth AS [Width]
FROM TransportDetails WITH (NOLOCK)
LEFT JOIN TransportStops [TransportDetails_Stop] WITH (NOLOCK) ON TransportDetails.TransportStopID = TransportDetails_Stop.IDTransportStop
WHERE [TransportDetails_Stop].TransportID = '0273339f-86ad-43ae-37d7-08dae6f3be3f'

--Duration: 36ms
--2023-05-17 09:47:27
SELECT DISTINCT [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier AS [CompanyIDSupplier]
FROM CompanyRateChargeTransportMatrixItems WITH (NOLOCK)
WHERE (
		N'YANTIAN' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCode IS NULL
		)
	AND (
		N'LOG' LIKE CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin + '%'
		OR CompanyRateChargeTransportMatrixItems.CompanyRateChargeTransportMatrixItemRegionCodeOrigin IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType = N'40HQ'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemThresholdType IS NULL
		)
	AND (
		[CompanyRateChargeTransportMatrixItems].SubContextCode = N'CN_PRSOCE'
		OR [CompanyRateChargeTransportMatrixItems].SubContextCode IS NULL
		)
	AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidFromDate <= '20221231'
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate > '20221231'
		OR [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemValidToDate IS NULL
		)
	AND [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier IS NOT NULL
	AND (
		[CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode IS NOT NULL
		AND [CompanyRateChargeTransportMatrixItems].CompanyRateChargeTransportMatrixItemRegionCode <> ''
		)
ORDER BY [CompanyRateChargeTransportMatrixItems].CompanyIDSupplier

--Duration: 505ms
--2023-05-17 09:47:27
SELECT TOP 1 1
FROM Charges WITH (NOLOCK)
WHERE [Charges].ChargeBookDateField IN (
		N'Transport_DeliveryDateTime'
		,N'Stop_DeliveryDateTime'
		)

--Duration: 27ms
--2023-05-17 09:47:27
SELECT [TransportDetails].IDTransportDetail AS [ID]
	,[TransportDetails].TransportDetailActualDateTimeOfArrival AS [ActualDateTimeOfArrival]
	,[TransportDetails].TransportDetailActualDateTimeOfDeparture AS [ActualDateTimeOfDeparture]
	,[TransportDetails].TransportDetailAddDateTime AS [AddDateTime]
	,[TransportDetails].TransportDetailAdditionalVolume AS [AdditionalVolume]
	,[TransportDetails].TransportDetailAddUserCode AS [AddUserCode]
	,[TransportDetails].TransportDetailCartons AS [Cartons]
	,[TransportDetails].TransportDetailCBLNumber AS [CBLNumber]
	,[TransportDetails].TransportDetailClientReference AS [ClientReference]
	,[TransportDetails].TransportDetailColliWeight AS [ColliWeight]
	,[TransportDetails].CompanyIDSupplier AS [CompanyIDSupplier]
	,[TransportDetails].TransportDetailConsigneeCompanyID AS [ConsigneeCompanyID]
	,[TransportDetails].TransportDetailCSNumber AS [CSNumber]
	,[TransportDetails].TransportDetailCSSequence AS [CSSequence]
	,[TransportDetails].TransportDetailCustomsConfirmed AS [CustomsConfirmed]
	,[TransportDetails].TransportDetailDeliveryCompanyID AS [DeliveryCompanyID]
	,[TransportDetails].TransportDetailDeliveryContact AS [DeliveryContact]
	,[TransportDetails].TransportDetailDeliveryDateTime AS [DeliveryDateTime]
	,[TransportDetails].TransportDetailDepth AS [Depth]
	,[TransportDetails].TransportDetailDocumentReference AS [DocumentReference]
	,[TransportDetails].TransportDetailEditDateTime AS [EditDateTime]
	,[TransportDetails].TransportDetailEditUserCode AS [EditUserCode]
	,[TransportDetails].TransportDetailEquipmentNumber AS [EquipmentNumber]
	,[TransportDetails].TransportDetailEquipmentSize AS [EquipmentSize]
	,[TransportDetails].TransportDetailEquipmentType AS [EquipmentType]
	,[TransportDetails].TransportDetailEstimatedDateTimeOfArrival AS [EstimatedDateTimeOfArrival]
	,[TransportDetails].TransportDetailEstimatedDateTimeOfDeparture AS [EstimatedDateTimeOfDeparture]
	,[TransportDetails].TransportDetailEstimatedPallets AS [EstimatedPallets]
	,[TransportDetails].TransportDetailGoThroughQuantity AS [GoThroughQuantity]
	,[TransportDetails].TransportDetailGoThroughUnitOfMeasure AS [GoThroughUnitOfMeasure]
	,[TransportDetails].TransportDetailHeight AS [Height]
	,[TransportDetails].IssueID AS [IssueID]
	,[TransportDetails].TransportDetailLeg AS [Leg]
	,[TransportDetails].TransportDetailLoadMetres AS [LoadMetres]
	,[TransportDetails].TransportDetailNotes AS [Notes]
	,[TransportDetails].OrderID AS [OrderID]
	,[TransportDetails].TransportDetailPallets AS [Pallets]
	,[TransportDetails].TransportDetailPalletType AS [PalletType]
	,[TransportDetails].TransportDetailPickUpCompanyID AS [PickUpCompanyID]
	,[TransportDetails].TransportDetailProductCode AS [ProductCode]
	,[TransportDetails].TransportDetailProductDescription AS [ProductDescription]
	,[TransportDetails].TransportDetailQuantity AS [Quantity]
	,[TransportDetails].ReceiptID AS [ReceiptID]
	,[TransportDetails].TransportDetailReference AS [Reference]
	,[TransportDetails].TransportDetailRegionCode AS [RegionCode]
	,[TransportDetails].TransportDetailRegionCodeOrigin AS [RegionCodeOrigin]
	,[TransportDetails].TransportDetailRequiresCustomsConfirmation AS [RequiresCustomsConfirmation]
	,[TransportDetails].ShipmentDetailID AS [ShipmentDetailID]
	,[TransportDetails].ShipmentID AS [ShipmentID]
	,[TransportDetails].ShipmentNumber AS [ShipmentNumber]
	,[TransportDetails].TransportDetailStackable AS [Stackable]
	,[TransportDetails].TransportDetailStatus AS [Status]
	,[TransportDetails].TransportDetailTemporaryEquipmentNumber AS [TemporaryEquipmentNumber]
	,[TransportDetails].TransportStopID AS [TransportStopID]
	,[TransportDetails].TransportDetailType AS [Type]
	,[TransportDetails].TransportDetailUnitOfMeasure AS [UnitOfMeasure]
	,[TransportDetails].TransportDetailUserDefinedDate01 AS [UserDefinedDate01]
	,[TransportDetails].TransportDetailUserDefinedDate02 AS [UserDefinedDate02]
	,[TransportDetails].TransportDetailUserDefinedDate03 AS [UserDefinedDate03]
	,[TransportDetails].TransportDetailUserDefinedDate04 AS [UserDefinedDate04]
	,[TransportDetails].TransportDetailUserDefinedDate05 AS [UserDefinedDate05]
	,[TransportDetails].TransportDetailUserDefinedDateTime01 AS [UserDefinedDateTime01]
	,[TransportDetails].TransportDetailUserDefinedDateTime02 AS [UserDefinedDateTime02]
	,[TransportDetails].TransportDetailUserDefinedDateTime03 AS [UserDefinedDateTime03]
	,[TransportDetails].TransportDetailUserDefinedDateTime04 AS [UserDefinedDateTime04]
	,[TransportDetails].TransportDetailUserDefinedDateTime05 AS [UserDefinedDateTime05]
	,[TransportDetails].TransportDetailUserDefinedDateTime06 AS [UserDefinedDateTime06]
	,[TransportDetails].TransportDetailUserDefinedDateTime07 AS [UserDefinedDateTime07]
	,[TransportDetails].TransportDetailUserDefinedDateTime09 AS [UserDefinedDateTime09]
	,[TransportDetails].TransportDetailUserDefinedDateTime10 AS [UserDefinedDateTime10]
	,[TransportDetails].TransportDetailUserDefinedLongText01 AS [UserDefinedLongText01]
	,[TransportDetails].TransportDetailUserDefinedLongText02 AS [UserDefinedLongText02]
	,[TransportDetails].TransportDetailUserDefinedLongText03 AS [UserDefinedLongText03]
	,[TransportDetails].TransportDetailUserDefinedLongText04 AS [UserDefinedLongText04]
	,[TransportDetails].TransportDetailUserDefinedLongText05 AS [UserDefinedLongText05]
	,[TransportDetails].TransportDetailUserDefinedNumber01 AS [UserDefinedNumber01]
	,[TransportDetails].TransportDetailUserDefinedNumber02 AS [UserDefinedNumber02]
	,[TransportDetails].TransportDetailUserDefinedNumber03 AS [UserDefinedNumber03]
	,[TransportDetails].TransportDetailUserDefinedNumber04 AS [UserDefinedNumber04]
	,[TransportDetails].TransportDetailUserDefinedNumber05 AS [UserDefinedNumber05]
	,[TransportDetails].TransportDetailUserDefinedText01 AS [UserDefinedText01]
	,[TransportDetails].TransportDetailUserDefinedText02 AS [UserDefinedText02]
	,[TransportDetails].TransportDetailUserDefinedText03 AS [UserDefinedText03]
	,[TransportDetails].TransportDetailUserDefinedText04 AS [UserDefinedText04]
	,[TransportDetails].TransportDetailUserDefinedText05 AS [UserDefinedText05]
	,[TransportDetails].TransportDetailUserDefinedText06 AS [UserDefinedText06]
	,[TransportDetails].TransportDetailUserDefinedText07 AS [UserDefinedText07]
	,[TransportDetails].TransportDetailUserDefinedText08 AS [UserDefinedText08]
	,[TransportDetails].TransportDetailUserDefinedText09 AS [UserDefinedText09]
	,[TransportDetails].TransportDetailUserDefinedText10 AS [UserDefinedText10]
	,[TransportDetails].TransportDetailUserDefinedText11 AS [UserDefinedText11]
	,[TransportDetails].TransportDetailUserDefinedText12 AS [UserDefinedText12]
	,[TransportDetails].TransportDetailUserDefinedText13 AS [UserDefinedText13]
	,[TransportDetails].TransportDetailUserDefinedText14 AS [UserDefinedText14]
	,[TransportDetails].TransportDetailUserDefinedText15 AS [UserDefinedText15]
	,[TransportDetails].TransportDetailUserDefinedYesNo01 AS [UserDefinedYesNo01]
	,[TransportDetails].TransportDetailUserDefinedYesNo02 AS [UserDefinedYesNo02]
	,[TransportDetails].TransportDetailUserDefinedYesNo03 AS [UserDefinedYesNo03]
	,[TransportDetails].TransportDetailUserDefinedYesNo04 AS [UserDefinedYesNo04]
	,[TransportDetails].TransportDetailUserDefinedYesNo05 AS [UserDefinedYesNo05]
	,[TransportDetails].TransportDetailVesselCode AS [VesselCode]
	,[TransportDetails].TransportDetailVesselName AS [VesselName]
	,[TransportDetails].TransportDetailVolume AS [Volume]
	,[TransportDetails].TransportDetailVoyageCode AS [VoyageCode]
	,[TransportDetails].TransportDetailWaveCode AS [WaveCode]
	,[TransportDetails].TransportDetailWeight AS [Weight]
	,[TransportDetails].TransportDetailWidth AS [Width]
FROM TransportDetails WITH (NOLOCK)
WHERE [TransportDetails].TransportStopID IN (
		'd2168e20-2ca9-4375-49a4-08dae6f3be71'
		,'a3e0f6a6-4ddd-4bb0-49a4-08dae6f3be71'
		)

--Duration: 34ms
--2023-05-17 09:47:27
SELECT [TransportStops].IDTransportStop AS [ID]
	,[TransportStops].TransportStopActionEndDateTime AS [ActionEndDateTime]
	,[TransportStops].TransportStopActionStartDateTime AS [ActionStartDateTime]
	,[TransportStops].TransportStopAddDateTime AS [AddDateTime]
	,[TransportStops].TransportStopAddUserCode AS [AddUserCode]
	,[TransportStops].TransportStopArrivalDateTime AS [ArrivalDateTime]
	,[TransportStops].TransportStopBillingWeight AS [BillingWeight]
	,[TransportStops].TransportStopCartons AS [Cartons]
	,[TransportStops].TransportStopCashOnDelivery AS [CashOnDelivery]
	,[TransportStops].TransportStopCashOnDeliveryCurrencyCode AS [CashOnDeliveryCurrencyCode]
	,[TransportStops].TransportStopCashOnDeliveryReference AS [CashOnDeliveryReference]
	,[TransportStops].TransportStopCompanyID AS [CompanyID]
	,[TransportStops].TransportStopCompanyName AS [CompanyName]
	,[TransportStops].TransportStopContainerNumber AS [ContainerNumber]
	,[TransportStops].TransportStopContainerSize AS [ContainerSize]
	,[TransportStops].TransportStopContainerType AS [ContainerType]
	,[TransportStops].TransportStopCurrencyCode AS [CurrencyCode]
	,[TransportStops].TransportStopCustomsStatus AS [CustomsStatus]
	,[TransportStops].TransportStopCustomsTypeCode AS [CustomsTypeCode]
	,[TransportStops].TransportStopDeliveryAddress1 AS [DeliveryAddress1]
	,[TransportStops].TransportStopDeliveryAddress2 AS [DeliveryAddress2]
	,[TransportStops].TransportStopDeliveryAddress3 AS [DeliveryAddress3]
	,[TransportStops].TransportStopDeliveryAddress4 AS [DeliveryAddress4]
	,[TransportStops].TransportStopDeliveryCity AS [DeliveryCity]
	,[TransportStops].TransportStopDeliveryCompanyID AS [DeliveryCompanyID]
	,[TransportStops].TransportStopDeliveryCompanyName AS [DeliveryCompanyName]
	,[TransportStops].TransportStopDeliveryContact AS [DeliveryContact]
	,[TransportStops].TransportStopDeliveryCountry AS [DeliveryCountry]
	,[TransportStops].TransportStopDeliveryDateTime AS [DeliveryDateTime]
	,[TransportStops].TransportStopDeliveryEmail AS [DeliveryEmail]
	,[TransportStops].TransportStopDeliveryFax AS [DeliveryFax]
	,[TransportStops].TransportStopDeliveryMoment AS [DeliveryMoment]
	,[TransportStops].TransportStopDeliveryPhone AS [DeliveryPhone]
	,[TransportStops].TransportStopDeliveryReference AS [DeliveryReference]
	,[TransportStops].TransportStopDeliveryReference2 AS [DeliveryReference2]
	,[TransportStops].TransportStopDeliveryRegionCode AS [DeliveryRegionCode]
	,[TransportStops].TransportStopDeliveryState AS [DeliveryState]
	,[TransportStops].TransportStopDeliveryZipCode AS [DeliveryZipCode]
	,[TransportStops].TransportStopDepartureDateTime AS [DepartureDateTime]
	,[TransportStops].TransportStopDistance AS [Distance]
	,[TransportStops].TransportStopDropOffLocationContainer AS [DropOffLocationContainer]
	,[TransportStops].TransportStopDropOffLocationName AS [DropOffLocationName]
	,[TransportStops].TransportStopEditDateTime AS [EditDateTime]
	,[TransportStops].TransportStopEditUserCode AS [EditUserCode]
	,[TransportStops].TransportStopEstimatedArrivalDateTimeVessel AS [EstimatedArrivalDateTimeVessel]
	,[TransportStops].TransportStopExternalOrderID AS [ExternalOrderID]
	,[TransportStops].TransportStopExternalReceiptID AS [ExternalReceiptID]
	,[TransportStops].TransportStopFreightWeight AS [FreightWeight]
	,[TransportStops].TransportStopGoThroughAddress1 AS [GoThroughAddress1]
	,[TransportStops].TransportStopGoThroughAddress2 AS [GoThroughAddress2]
	,[TransportStops].TransportStopGoThroughAddress3 AS [GoThroughAddress3]
	,[TransportStops].TransportStopGoThroughAddress4 AS [GoThroughAddress4]
	,[TransportStops].TransportStopGoThroughCity AS [GoThroughCity]
	,[TransportStops].TransportStopGoThroughCompanyID AS [GoThroughCompanyID]
	,[TransportStops].TransportStopGoThroughCountry AS [GoThroughCountry]
	,[TransportStops].TransportStopGoThroughDateTime AS [GoThroughDateTime]
	,[TransportStops].TransportStopGoThroughReference AS [GoThroughReference]
	,[TransportStops].TransportStopGoThroughState AS [GoThroughState]
	,[TransportStops].TransportStopGoThroughZipCode AS [GoThroughZipCode]
	,[TransportStops].TransportStopHandInAvailableFromDateTime AS [HandInAvailableFromDateTime]
	,[TransportStops].TransportStopHandInBeforeDateTime AS [HandInBeforeDateTime]
	,[TransportStops].TransportStopHandInReference AS [HandInReference]
	,[TransportStops].TransportStopLoadMetres AS [LoadMetres]
	,[TransportStops].TransportStopMileStoneRemarksCarrier AS [MileStoneRemarksCarrier]
	,[TransportStops].TransportStopMileStoneRemarksInternal AS [MileStoneRemarksInternal]
	,[TransportStops].TransportStopNumber AS [Number]
	,[TransportStops].OrderID AS [OrderID]
	,[TransportStops].TransportStopOrderStatus AS [OrderStatus]
	,[TransportStops].TransportStopOrderStatusID AS [OrderStatusID]
	,[TransportStops].TransportStopOriginalDeliveryZipCode AS [OriginalDeliveryZipCode]
	,[TransportStops].TransportStopOriginalPickUpZipCode AS [OriginalPickUpZipCode]
	,[TransportStops].TransportStopOriginalSubContext AS [OriginalSubContext]
	,[TransportStops].TransportStopOriginalType AS [OriginalType]
	,[TransportStops].TransportStopOriginCountry AS [OriginCountry]
	,[TransportStops].TransportStopPallets AS [Pallets]
	,[TransportStops].TransportStopPickUpAddress1 AS [PickUpAddress1]
	,[TransportStops].TransportStopPickUpAddress2 AS [PickUpAddress2]
	,[TransportStops].TransportStopPickUpAddress3 AS [PickUpAddress3]
	,[TransportStops].TransportStopPickUpAddress4 AS [PickUpAddress4]
	,[TransportStops].TransportStopPickUpCity AS [PickUpCity]
	,[TransportStops].TransportStopPickUpCompanyID AS [PickUpCompanyID]
	,[TransportStops].TransportStopPickupCompanyName AS [PickupCompanyName]
	,[TransportStops].TransportStopPickUpCountry AS [PickUpCountry]
	,[TransportStops].TransportStopPickupDateTime AS [PickupDateTime]
	,[TransportStops].TransportStopPickUpMoment AS [PickUpMoment]
	,[TransportStops].TransportStopPickUpReference AS [PickUpReference]
	,[TransportStops].TransportStopPickUpState AS [PickUpState]
	,[TransportStops].TransportStopPickUpZipCode AS [PickUpZipCode]
	,[TransportStops].TransportStopPinCode AS [PinCode]
	,[TransportStops].TransportStopPODOnTime AS [PODOnTime]
	,[TransportStops].ReceiptID AS [ReceiptID]
	,[TransportStops].TransportStopReceiptStatus AS [ReceiptStatus]
	,[TransportStops].TransportStopReceiptStatusID AS [ReceiptStatusID]
	,[TransportStops].TransportStopRemarks AS [Remarks]
	,[TransportStops].TransportStopSealNumber AS [SealNumber]
	,[TransportStops].TransportStopShipName AS [ShipName]
	,[TransportStops].TransportStopSMSOnTime AS [SMSOnTime]
	,[TransportStops].TransportStopTariffAgreed AS [TariffAgreed]
	,[TransportStops].TransportID AS [TransportID]
	,[TransportStops].TransportStopIDMainStop AS [TransportStopIDMainStop]
	,[TransportStops].TransportStopType AS [Type]
	,[TransportStops].TransportStopUserDefinedDate01 AS [UserDefinedDate01]
	,[TransportStops].TransportStopUserDefinedDate02 AS [UserDefinedDate02]
	,[TransportStops].TransportStopUserDefinedDateTime01 AS [UserDefinedDateTime01]
	,[TransportStops].TransportStopUserDefinedDateTime02 AS [UserDefinedDateTime02]
	,[TransportStops].TransportStopUserDefinedDateTime03 AS [UserDefinedDateTime03]
	,[TransportStops].TransportStopUserDefinedDateTime04 AS [UserDefinedDateTime04]
	,[TransportStops].TransportStopUserDefinedDateTime05 AS [UserDefinedDateTime05]
	,[TransportStops].TransportStopUserDefinedDateTime06 AS [UserDefinedDateTime06]
	,[TransportStops].TransportStopUserDefinedDateTime07 AS [UserDefinedDateTime07]
	,[TransportStops].TransportStopUserDefinedDateTime09 AS [UserDefinedDateTime09]
	,[TransportStops].TransportStopUserDefinedDateTime10 AS [UserDefinedDateTime10]
	,[TransportStops].TransportStopUserDefinedLongText01 AS [UserDefinedLongText01]
	,[TransportStops].TransportStopUserDefinedLongText02 AS [UserDefinedLongText02]
	,[TransportStops].TransportStopUserDefinedLongText03 AS [UserDefinedLongText03]
	,[TransportStops].TransportStopUserDefinedLongText04 AS [UserDefinedLongText04]
	,[TransportStops].TransportStopUserDefinedLongText05 AS [UserDefinedLongText05]
	,[TransportStops].TransportStopUserDefinedNumber01 AS [UserDefinedNumber01]
	,[TransportStops].TransportStopUserDefinedNumber02 AS [UserDefinedNumber02]
	,[TransportStops].TransportStopUserDefinedNumber03 AS [UserDefinedNumber03]
	,[TransportStops].TransportStopUserDefinedNumber04 AS [UserDefinedNumber04]
	,[TransportStops].TransportStopUserDefinedNumber05 AS [UserDefinedNumber05]
	,[TransportStops].TransportStopUserDefinedText01 AS [UserDefinedText01]
	,[TransportStops].TransportStopUserDefinedText02 AS [UserDefinedText02]
	,[TransportStops].TransportStopUserDefinedText03 AS [UserDefinedText03]
	,[TransportStops].TransportStopUserDefinedText04 AS [UserDefinedText04]
	,[TransportStops].TransportStopUserDefinedText05 AS [UserDefinedText05]
	,[TransportStops].TransportStopUserDefinedText06 AS [UserDefinedText06]
	,[TransportStops].TransportStopUserDefinedText07 AS [UserDefinedText07]
	,[TransportStops].TransportStopUserDefinedText08 AS [UserDefinedText08]
	,[TransportStops].TransportStopUserDefinedText09 AS [UserDefinedText09]
	,[TransportStops].TransportStopUserDefinedText10 AS [UserDefinedText10]
	,[TransportStops].TransportStopUserDefinedText11 AS [UserDefinedText11]
	,[TransportStops].TransportStopUserDefinedText12 AS [UserDefinedText12]
	,[TransportStops].TransportStopUserDefinedText13 AS [UserDefinedText13]
	,[TransportStops].TransportStopUserDefinedText14 AS [UserDefinedText14]
	,[TransportStops].TransportStopUserDefinedText15 AS [UserDefinedText15]
	,[TransportStops].TransportStopUserDefinedYesNo01 AS [UserDefinedYesNo01]
	,[TransportStops].TransportStopUserDefinedYesNo02 AS [UserDefinedYesNo02]
	,[TransportStops].TransportStopUserDefinedYesNo03 AS [UserDefinedYesNo03]
	,[TransportStops].TransportStopUserDefinedYesNo04 AS [UserDefinedYesNo04]
	,[TransportStops].TransportStopUserDefinedYesNo05 AS [UserDefinedYesNo05]
	,[TransportStops].TransportStopVolume AS [Volume]
	,[TransportStops].TransportStopWaitingTime AS [WaitingTime]
FROM TransportStops WITH (NOLOCK)
WHERE [TransportStops].TransportID = '0273339f-86ad-43ae-37d7-08dae6f3be3f'

--Duration: 121ms
--2023-05-17 09:47:26
SELECT [Transports].IDTransport AS [ID]
	,[Transports].TransportActualArrivalDateTime AS [ActualArrivalDateTime]
	,[Transports].TransportActualCarrierID AS [ActualCarrierID]
	,[Transports].TransportAddDateTime AS [AddDateTime]
	,[Transports].TransportAddUserCode AS [AddUserCode]
	,[Transports].TransportBasedOnOptimization AS [BasedOnOptimization]
	,[Transports].TransportCarrierEmail AS [CarrierEmail]
	,[Transports].TransportCarrierID AS [CarrierID]
	,[Transports].TransportCarrierName AS [CarrierName]
	,[Transports].TransportCarrierRemarks AS [CarrierRemarks]
	,[Transports].TransportChangedDataStorageString AS [ChangedDataStorageString]
	,[Transports].TransportChangesAcceptedDateTime AS [ChangesAcceptedDateTime]
	,[Transports].TransportCharges AS [Charges]
	,[Transports].TransportCheapestSolutionCost AS [CheapestSolutionCost]
	,[Transports].TransportCheapestSolutionRevenue AS [CheapestSolutionRevenue]
	,[Transports].TransportChosenNonOptimalReason AS [ChosenNonOptimalReason]
	,[Transports].TransportChosenNonOptimalReasonCode AS [ChosenNonOptimalReasonCode]
	,[Transports].TransportChosenSolutionCost AS [ChosenSolutionCost]
	,[Transports].TransportChosenSolutionRevenue AS [ChosenSolutionRevenue]
	,[Transports].TransportCompanyID AS [CompanyID]
	,[Transports].TransportContact AS [Contact]
	,[Transports].TransportContactEmail AS [ContactEmail]
	,[Transports].TransportContactPhone AS [ContactPhone]
	,[Transports].TransportContainerNumber AS [ContainerNumber]
	,[Transports].TransportContainerType AS [ContainerType]
	,[Transports].TransportCostsEstimated AS [CostsEstimated]
	,[Transports].TransportCostsParkingFee AS [CostsParkingFee]
	,[Transports].TransportCostsRoadTolls AS [CostsRoadTolls]
	,[Transports].TransportCostsWaitingFee AS [CostsWaitingFee]
	,[Transports].CountryCode AS [CountryCode]
	,[Transports].TransportCreationDataSource AS [CreationDataSource]
	,[Transports].TransportCreationRunDateTime AS [CreationRunDateTime]
	,[Transports].CurrencyCode AS [CurrencyCode]
	,[Transports].TransportCustomsConfirmed AS [CustomsConfirmed]
	,[Transports].DataEntryDefinitionID AS [DataEntryDefinitionID]
	,[Transports].TransportDeliveryDateTime AS [DeliveryDateTime]
	,[Transports].TransportDepartment AS [Department]
	,[Transports].TransportDirect AS [Direct]
	,[Transports].TransportDiscrepancey AS [Discrepancey]
	,[Transports].TransportDock AS [Dock]
	,[Transports].TransportDockDateTime AS [DockDateTime]
	,[Transports].TransportDockIsCleared AS [DockIsCleared]
	,[Transports].TransportEditDateTime AS [EditDateTime]
	,[Transports].TransportEditUserCode AS [EditUserCode]
	,[Transports].TransportEndLoadingDateTime AS [EndLoadingDateTime]
	,[Transports].TransportEndUnloadingDateTime AS [EndUnloadingDateTime]
	,[Transports].TransportEstimatedDateTimeOfArrival AS [EstimatedDateTimeOfArrival]
	,[Transports].TransportEstimatedDateTimeOfDeparture AS [EstimatedDateTimeOfDeparture]
	,[Transports].TransportExternalCompanySavedChargesDateTime AS [ExternalCompanySavedChargesDateTime]
	,[Transports].TransportExtraStopCosts AS [ExtraStopCosts]
	,[Transports].TransportFileUploadCount AS [FileUploadCount]
	,[Transports].TransportFreightWeight AS [FreightWeight]
	,[Transports].TransportFuelSurcharge AS [FuelSurcharge]
	,[Transports].TransportFuelSurchargePercentage AS [FuelSurchargePercentage]
	,[Transports].TransportHaulageType AS [HaulageType]
	,[Transports].TransportImportBatch AS [ImportBatch]
	,[Transports].TransportInternalNotes AS [InternalNotes]
	,[Transports].TransportLastChequeNumber AS [LastChequeNumber]
	,[Transports].TransportLastComment AS [LastComment]
	,[Transports].TransportLastExternalChangeDateTime AS [LastExternalChangeDateTime]
	,[Transports].TransportLastFlagExternalChangeHandledDateTime AS [LastFlagExternalChangeHandledDateTime]
	,[Transports].TransportLastStopMoveDateTime AS [LastStopMoveDateTime]
	,[Transports].TransportLoadMetres AS [LoadMetres]
	,[Transports].TransportNewEDIPending AS [NewEDIPending]
	,[Transports].TransportNotes AS [Notes]
	,[Transports].TransportNumber AS [Number]
	,[Transports].TransportOptimizationPlanName AS [OptimizationPlanName]
	,[Transports].TransportOptimizationPlanRunID AS [OptimizationPlanRunID]
	,[Transports].PalletTypeCode AS [PalletTypeCode]
	,[Transports].TransportPickUpAddress1 AS [PickUpAddress1]
	,[Transports].TransportPickUpAddress2 AS [PickUpAddress2]
	,[Transports].TransportPickUpAddress3 AS [PickUpAddress3]
	,[Transports].TransportPickUpAddress4 AS [PickUpAddress4]
	,[Transports].TransportPickUpCity AS [PickUpCity]
	,[Transports].TransportPickUpCompanyID AS [PickUpCompanyID]
	,[Transports].TransportPickupCompanyName AS [PickupCompanyName]
	,[Transports].TransportPickUpCountry AS [PickUpCountry]
	,[Transports].TransportPickupDateTime AS [PickupDateTime]
	,[Transports].TransportPickupMoment AS [PickupMoment]
	,[Transports].TransportPickUpReference AS [PickUpReference]
	,[Transports].TransportPickUpState AS [PickUpState]
	,[Transports].TransportPickUpZipCode AS [PickUpZipCode]
	,[Transports].TransportPurchaseOrderNumber AS [PurchaseOrderNumber]
	,[Transports].TransportReadyForBillingDateTime AS [ReadyForBillingDateTime]
	,[Transports].TransportReadyForMatrixBillingDateTime AS [ReadyForMatrixBillingDateTime]
	,[Transports].TransportReadyForWaitingTimeBillingDateTime AS [ReadyForWaitingTimeBillingDateTime]
	,[Transports].TransportRoute AS [Route]
	,[Transports].TransportRuleType AS [RuleType]
	,[Transports].TransportSalesOrderNumber AS [SalesOrderNumber]
	,[Transports].TransportSeal1 AS [Seal1]
	,[Transports].TransportSeal2 AS [Seal2]
	,[Transports].TransportStartLoadingDateTime AS [StartLoadingDateTime]
	,[Transports].TransportStartUnloadingDateTime AS [StartUnloadingDateTime]
	,[Transports].TransportStatusChangeDateTime AS [StatusChangeDateTime]
	,[Transports].TransportStatusID AS [StatusID]
	,[Transports].TransportStatusIDPrevious AS [StatusIDPrevious]
	,[Transports].TransportStopIDFirst AS [StopIDFirst]
	,[Transports].TransportStopIDLast AS [StopIDLast]
	,[Transports].SubContextCode AS [SubContextCode]
	,[Transports].TransportThresholdType AS [ThresholdType]
	,[Transports].TransportTrailer2LicensePlate AS [Trailer2LicensePlate]
	,[Transports].TransportTrailerLicensePlate AS [TrailerLicensePlate]
	,[Transports].TransportTransportCosts AS [TransportCosts]
	,[Transports].TransportTruck2LicensePlate AS [Truck2LicensePlate]
	,[Transports].TransportTruckDriver AS [TruckDriver]
	,[Transports].TransportTruckLicensePlate AS [TruckLicensePlate]
	,[Transports].TransportTruckPhone AS [TruckPhone]
	,[Transports].TransportTruckType AS [TruckType]
	,[Transports].TransportType AS [Type]
	,[Transports].TransportUserDefinedDate01 AS [UserDefinedDate01]
	,[Transports].TransportUserDefinedDate02 AS [UserDefinedDate02]
	,[Transports].TransportUserDefinedDateTime01 AS [UserDefinedDateTime01]
	,[Transports].TransportUserDefinedDateTime02 AS [UserDefinedDateTime02]
	,[Transports].TransportUserDefinedDateTime03 AS [UserDefinedDateTime03]
	,[Transports].TransportUserDefinedDateTime04 AS [UserDefinedDateTime04]
	,[Transports].TransportUserDefinedDateTime05 AS [UserDefinedDateTime05]
	,[Transports].TransportUserDefinedDateTime06 AS [UserDefinedDateTime06]
	,[Transports].TransportUserDefinedDateTime07 AS [UserDefinedDateTime07]
	,[Transports].TransportUserDefinedDateTime08 AS [UserDefinedDateTime08]
	,[Transports].TransportUserDefinedDateTime09 AS [UserDefinedDateTime09]
	,[Transports].TransportUserDefinedDateTime10 AS [UserDefinedDateTime10]
	,[Transports].TransportUserDefinedDateTime11 AS [UserDefinedDateTime11]
	,[Transports].TransportUserDefinedDateTime12 AS [UserDefinedDateTime12]
	,[Transports].TransportUserDefinedDateTime13 AS [UserDefinedDateTime13]
	,[Transports].TransportUserDefinedDateTime14 AS [UserDefinedDateTime14]
	,[Transports].TransportUserDefinedDateTime15 AS [UserDefinedDateTime15]
	,[Transports].TransportUserDefinedLongText01 AS [UserDefinedLongText01]
	,[Transports].TransportUserDefinedLongText02 AS [UserDefinedLongText02]
	,[Transports].TransportUserDefinedLongText03 AS [UserDefinedLongText03]
	,[Transports].TransportUserDefinedLongText04 AS [UserDefinedLongText04]
	,[Transports].TransportUserDefinedLongText05 AS [UserDefinedLongText05]
	,[Transports].TransportUserDefinedNumber01 AS [UserDefinedNumber01]
	,[Transports].TransportUserDefinedNumber02 AS [UserDefinedNumber02]
	,[Transports].TransportUserDefinedNumber03 AS [UserDefinedNumber03]
	,[Transports].TransportUserDefinedNumber04 AS [UserDefinedNumber04]
	,[Transports].TransportUserDefinedNumber05 AS [UserDefinedNumber05]
	,[Transports].TransportUserDefinedNumber06 AS [UserDefinedNumber06]
	,[Transports].TransportUserDefinedNumber07 AS [UserDefinedNumber07]
	,[Transports].TransportUserDefinedNumber08 AS [UserDefinedNumber08]
	,[Transports].TransportUserDefinedNumber09 AS [UserDefinedNumber09]
	,[Transports].TransportUserDefinedNumber10 AS [UserDefinedNumber10]
	,[Transports].TransportUserDefinedNumber11 AS [UserDefinedNumber11]
	,[Transports].TransportUserDefinedNumber12 AS [UserDefinedNumber12]
	,[Transports].TransportUserDefinedNumber13 AS [UserDefinedNumber13]
	,[Transports].TransportUserDefinedNumber14 AS [UserDefinedNumber14]
	,[Transports].TransportUserDefinedNumber15 AS [UserDefinedNumber15]
	,[Transports].TransportUserDefinedNumber16 AS [UserDefinedNumber16]
	,[Transports].TransportUserDefinedNumber17 AS [UserDefinedNumber17]
	,[Transports].TransportUserDefinedNumber18 AS [UserDefinedNumber18]
	,[Transports].TransportUserDefinedNumber19 AS [UserDefinedNumber19]
	,[Transports].TransportUserDefinedNumber20 AS [UserDefinedNumber20]
	,[Transports].TransportUserDefinedText01 AS [UserDefinedText01]
	,[Transports].TransportUserDefinedText02 AS [UserDefinedText02]
	,[Transports].TransportUserDefinedText03 AS [UserDefinedText03]
	,[Transports].TransportUserDefinedText04 AS [UserDefinedText04]
	,[Transports].TransportUserDefinedText05 AS [UserDefinedText05]
	,[Transports].TransportUserDefinedText06 AS [UserDefinedText06]
	,[Transports].TransportUserDefinedText07 AS [UserDefinedText07]
	,[Transports].TransportUserDefinedText08 AS [UserDefinedText08]
	,[Transports].TransportUserDefinedText09 AS [UserDefinedText09]
	,[Transports].TransportUserDefinedText10 AS [UserDefinedText10]
	,[Transports].TransportUserDefinedText11 AS [UserDefinedText11]
	,[Transports].TransportUserDefinedText12 AS [UserDefinedText12]
	,[Transports].TransportUserDefinedText13 AS [UserDefinedText13]
	,[Transports].TransportUserDefinedText14 AS [UserDefinedText14]
	,[Transports].TransportUserDefinedText15 AS [UserDefinedText15]
	,[Transports].TransportUserDefinedYesNo01 AS [UserDefinedYesNo01]
	,[Transports].TransportUserDefinedYesNo02 AS [UserDefinedYesNo02]
	,[Transports].TransportUserDefinedYesNo03 AS [UserDefinedYesNo03]
	,[Transports].TransportUserDefinedYesNo04 AS [UserDefinedYesNo04]
	,[Transports].TransportUserDefinedYesNo05 AS [UserDefinedYesNo05]
	,[Transports].TransportValueAddedTax AS [ValueAddedTax]
	,[Transports].TransportVesselCode AS [VesselCode]
	,[Transports].TransportVesselName AS [VesselName]
	,[Transports].TransportVolume AS [Volume]
	,[Transports].TransportVoyageCode AS [VoyageCode]
	,[Transports].TransportWaitingFeeEstimated AS [WaitingFeeEstimated]
FROM Transports WITH (NOLOCK)
WHERE [Transports].IDTransport = '0273339f-86ad-43ae-37d7-08dae6f3be3f'

--Duration: 6ms
--2023-05-17 09:47:26
SELECT [TransportStatuses].IDTransportStatus AS [ID]
	,[TransportStatuses].TransportStatusActionIsRarelyUsed AS [ActionIsRarelyUsed]
	,[TransportStatuses].TransportStatusActionName AS [ActionName]
	,[TransportStatuses].TransportStatusActionTooltip AS [ActionTooltip]
	,[TransportStatuses].TransportStatusActionType AS [ActionType]
	,[TransportStatuses].TransportStatusAddDateTime AS [AddDateTime]
	,[TransportStatuses].TransportStatusAddRemarkAccessRight AS [AddRemarkAccessRight]
	,[TransportStatuses].TransportStatusAddUserCode AS [AddUserCode]
	,[TransportStatuses].TransportStatusAllowManualPriceCalculation AS [AllowManualPriceCalculation]
	,[TransportStatuses].TransportStatusAllowOrderSelection AS [AllowOrderSelection]
	,[TransportStatuses].TransportStatusAllowPriceCalculation AS [AllowPriceCalculation]
	,[TransportStatuses].TransportStatusAllowReceiptSelection AS [AllowReceiptSelection]
	,[TransportStatuses].TransportStatusCancelled AS [Cancelled]
	,[TransportStatuses].TransportStatusChangeAllActionName AS [ChangeAllActionName]
	,[TransportStatuses].TransportStatusChangeAllActionTooltip AS [ChangeAllActionTooltip]
	,[TransportStatuses].TransportStatusChangeAllConfirmationMessage AS [ChangeAllConfirmationMessage]
	,[TransportStatuses].TransportStatusConfirmationMessage AS [ConfirmationMessage]
	,[TransportStatuses].TransportStatusConfirmCustomsAccessRight AS [ConfirmCustomsAccessRight]
	,[TransportStatuses].TransportStatusDisplayName AS [DisplayName]
	,[TransportStatuses].TransportStatusDone AS [Done]
	,[TransportStatuses].TransportStatusEditAccessRight AS [EditAccessRight]
	,[TransportStatuses].TransportStatusEditDateTime AS [EditDateTime]
	,[TransportStatuses].TransportStatusEditUserCode AS [EditUserCode]
	,[TransportStatuses].TransportStatusGoBackToListingAfterChange AS [GoBackToListingAfterChange]
	,[TransportStatuses].TransportStatusListingActionName AS [ListingActionName]
	,[TransportStatuses].TransportStatusListingActionTooltip AS [ListingActionTooltip]
	,[TransportStatuses].TransportStatusListingConfirmationMessage AS [ListingConfirmationMessage]
	,[TransportStatuses].TransportStatusMaximumChangedItemsAtOnce AS [MaximumChangedItemsAtOnce]
	,[TransportStatuses].TransportStatusModule AS [Module]
	,[TransportStatuses].TransportStatusModuleUpdateType AS [ModuleUpdateType]
	,[TransportStatuses].TransportStatusName AS [Name]
	,[TransportStatuses].TransportStatusNotes AS [Notes]
	,[TransportStatuses].TransportStatusNumber AS [Number]
	,[TransportStatuses].TransportStatusOrderActionName AS [OrderActionName]
	,[TransportStatuses].TransportStatusOrderActionTooltip AS [OrderActionTooltip]
	,[TransportStatuses].TransportStatusReadyForBilling AS [ReadyForBilling]
	,[TransportStatuses].TransportStatusReadyForInvoicing AS [ReadyForInvoicing]
	,[TransportStatuses].TransportStatusReadyForMatrixBilling AS [ReadyForMatrixBilling]
	,[TransportStatuses].TransportStatusReadyForWaitingTimeBilling AS [ReadyForWaitingTimeBilling]
	,[TransportStatuses].TransportStatusRecalculateForOrderChange AS [RecalculateForOrderChange]
	,[TransportStatuses].TransportStatusRecalculateForReceiptChange AS [RecalculateForReceiptChange]
	,[TransportStatuses].TransportStatusReceiptActionName AS [ReceiptActionName]
	,[TransportStatuses].TransportStatusReceiptActionTooltip AS [ReceiptActionTooltip]
	,[TransportStatuses].TransportStatusRequiresValidation AS [RequiresValidation]
	,[TransportStatuses].TransportStatusSetMessage AS [SetMessage]
	,[TransportStatuses].TransportStatusShowPriceToCustomer AS [ShowPriceToCustomer]
	,[TransportStatuses].TransportStatusStatusChangeAccessRight AS [StatusChangeAccessRight]
	,[TransportStatuses].TransportStatusViewAccessRight AS [ViewAccessRight]
	,[TransportStatuses].TransportStatusWarningLevel AS [WarningLevel]
FROM TransportStatuses WITH (NOLOCK)
WHERE [TransportStatuses].TransportStatusModule = N'Transports'

--Duration: 2ms
--2023-05-17 09:47:26
SELECT [DataEntryDefinitionOptions].DataEntryDefinitionOptionCode AS [Code]
	,[DataEntryDefinitionOptions].DataEntryDefinitionID AS [DefinitionID]
	,[DataEntryDefinitionOptions].DataEntryDefinitionOptionAddDateTime AS [AddDateTime]
	,[DataEntryDefinitionOptions].DataEntryDefinitionOptionAddUserCode AS [AddUserCode]
	,[DataEntryDefinitionOptions].DataEntryDefinitionOptionEditDateTime AS [EditDateTime]
	,[DataEntryDefinitionOptions].DataEntryDefinitionOptionEditUserCode AS [EditUserCode]
	,[DataEntryDefinitionOptions].DataEntryDefinitionOptionValue AS [Value]
FROM DataEntryDefinitionOptions WITH (NOLOCK)
LEFT JOIN DataEntryDefinitions [DataEntryDefinitionOptions_Definition] WITH (NOLOCK) ON DataEntryDefinitionOptions.DataEntryDefinitionID = DataEntryDefinitionOptions_Definition.IDDataEntryDefinition
WHERE [DataEntryDefinitionOptions].DataEntryDefinitionOptionCode IN (
		N'AllowExcelImport'
		,N'AddButtonText'
		,N'StartStatus'
		)
	AND [DataEntryDefinitionOptions_Definition].DataEntryDefinitionDataEntryType = N'Transport'
ORDER BY CAST([DataEntryDefinitionOptions].DataEntryDefinitionOptionValue AS NVARCHAR(max)) DESC
	--Duration: 159ms